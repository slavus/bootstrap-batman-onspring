<!doctype html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>batman.js | documentation</title>

  <script src="http://use.typekit.com/kek3ffx.js"></script>
  <script>try{Typekit.load();}catch(e){}</script>
  <link href="http://fonts.googleapis.com/css?family=PT+Mono" rel="stylesheet" type="text/css">
  <link href="css/style.css" media="screen" rel="stylesheet" type="text/css" />

  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body>

  <div id="top" class="container clearfix">

    <a class="to-top" id="fixed-goto-top" href="#top">Top</a>

    <!-- Left Navigation -->
    <div class="sidebar">

      <input id="quick-search" type="search" placeholder="Search">

      <nav>
        <ul id="table-of-contents" class="nav-list">
            <li><a href="#" class=""></a>
<ul>
  <li ><a href="#batman-js" class="">batman.js</a>
<ul>
  <li ><a href="#batman-js-its-got" class="">It&#39;s got:</a>
<ul>
  <li ><a href="#batman-js-its-got-platforms" class="">Platforms</a>
</li>
</ul>
</li>
  <li ><a href="#batman-js-installation" class="">Installation</a>
<ul>
  <li ><a href="#batman-js-installation-standalone-browser-version" class="">Standalone Browser Version</a>
</li>
  <li ><a href="#batman-js-installation-node-js" class="">node.js</a>
</li>
</ul>
</li>
  <li ><a href="#batman-js-architecture" class="">Architecture</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-helpers" class="class">Batman Helpers</a>
<ul>
  <li class="searchable"><a href="#batman-helpers-container" class="class-function">container</a>
</li>
  <li class="searchable"><a href="#batman-helpers-typeof" class="class-function">typeOf(object)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-mixin" class="class-function">mixin(subject, objects...)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-unmixin" class="class-function">unmixin(subject, objects...)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-ischildof" class="class-function">isChildOf(parent, child)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-setimmediate" class="class-function">setImmediate(callback)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-clearimmediate" class="class-function">clearImmediate(handle)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-foreach" class="class-function">forEach(iterable, iterator[, context])</a>
</li>
  <li class="searchable"><a href="#batman-helpers-objecthaskey" class="class-function">objectHasKey(object, key)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-contains" class="class-function">contains(object, item)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-get" class="class-function">get(object, key)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-escapehtml" class="class-function">escapeHTML(string)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-helpers" class="class">Batman.helpers</a>
<ul>
  <li class="searchable"><a href="#batman-helpers-ordinalize" class="class-function">ordinalize(value)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-singularize" class="class-function">singularize(pluralString)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-pluralize" class="class-function">pluralize(singularString)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-camelize" class="class-function">camelize(string, [lowercaseFirstLetter])</a>
</li>
  <li class="searchable"><a href="#batman-helpers-underscore" class="class-function">underscore(string)</a>
</li>
  <li class="searchable"><a href="#batman-helpers-capitalize" class="class-function">capitalize(string)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-eventemitter" class="class">Batman.EventEmitter</a>
<ul>
  <li class="searchable"><a href="#batman-eventemitter-on" class="class-function">on(key, handler)</a>
</li>
  <li class="searchable"><a href="#batman-eventemitter-fire" class="class-function">fire(key, arguments...)</a>
</li>
  <li class="searchable"><a href="#batman-eventemitter-hasevent" class="class-function">hasEvent(key)</a>
</li>
  <li class="searchable"><a href="#batman-eventemitter-oneshot" class="class-function">oneShot</a>
</li>
  <li class="searchable"><a href="#batman-eventemitter-prevent" class="class-function">prevent(key)</a>
</li>
  <li class="searchable"><a href="#batman-eventemitter-allow" class="class-function">allow(key)</a>
</li>
  <li class="searchable"><a href="#batman-eventemitter-allowandfire" class="class-function">allowAndFire(key)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-observable" class="class">Batman.Observable</a>
<ul>
  <li class="searchable"><a href="#batman-observable-get" class="class-function">get(keypath)</a>
</li>
  <li class="searchable"><a href="#batman-observable-set" class="class-function">set(keypath, newValue)</a>
</li>
  <li class="searchable"><a href="#batman-observable-unset" class="class-function">unset(keypath)</a>
</li>
  <li class="searchable"><a href="#batman-observable-observe" class="class-function">observe(key, observerCallback)</a>
</li>
  <li class="searchable"><a href="#batman-observable-observeandfire" class="class-function">observeAndFire(key, observerCallback)</a>
</li>
  <li class="searchable"><a href="#batman-observable-forget" class="class-function">forget([key [, observerCallback]])</a>
</li>
  <li class="searchable"><a href="#batman-observable-getorset" class="class-function">getOrSet(keypath, valueFunction)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-object" class="class">Batman.Object</a>
<ul>
  <li class="searchable"><a href="#batman-object-accessor" class="class-function">@accessor([keys...], objectOrFunction)</a>
<ul>
  <li ><a href="#batman-object-accessor-arguments" class="">Arguments</a>
</li>
  <li ><a href="#batman-object-accessor-uses" class="">Uses</a>
</li>
  <li ><a href="#batman-object-accessor-caveats" class="">Caveats</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-object-classaccessor" class="class-function">@classAccessor([keys...], objectOrFunction)</a>
</li>
  <li class="searchable"><a href="#batman-object-mixin" class="class-function">@mixin(objects...)</a>
</li>
  <li class="searchable"><a href="#batman-object-classmixin" class="class-function">@classMixin(objects...)</a>
</li>
  <li class="searchable"><a href="#batman-object-observeall" class="class-function">@observeAll(key, callback)</a>
</li>
  <li class="searchable"><a href="#batman-object-constructor" class="class-function">constructor(objects...)</a>
</li>
  <li class="searchable"><a href="#batman-object-tojson" class="class-function">toJSON()</a>
</li>
  <li class="searchable"><a href="#batman-object-hashkey" class="class-function">hashKey()</a>
</li>
  <li class="searchable"><a href="#batman-object-accessor" class="class-function">accessor([keys...], objectOrFunction)</a>
</li>
  <li class="searchable"><a href="#batman-object-mixin" class="class-function">mixin(objects...)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-simpleset" class="class">Batman.SimpleSet</a>
<ul>
  <li class="searchable"><a href="#batman-simpleset-simpleset-vs-set" class="">SimpleSet vs Set</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-constructor" class="class-function">constructor(items...)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-length" class="class-function">length</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-has" class="class-function">has(item)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-add" class="class-function">add(items...)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-remove" class="class-function">remove(items...)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-find" class="class-function">find(testFunction)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-foreach" class="class-function">forEach(iteratorFunction[, context])</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-isempty" class="class-function">isEmpty()</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-clear" class="class-function">clear()</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-replace" class="class-function">replace(collection)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-toarray" class="class-function">toArray()</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-merge" class="class-function">merge(collections...)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-indexedby" class="class-function">indexedBy(key)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-indexedbyunique" class="class-function">indexedByUnique(key)</a>
</li>
  <li class="searchable"><a href="#batman-simpleset-sortedby" class="class-function">sortedBy(key)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-set" class="class">Batman.Set</a>
<ul>
  <li class="searchable"><a href="#batman-set-simpleset-vs-set" class="">SimpleSet vs Set</a>
</li>
  <li class="searchable"><a href="#batman-set-constructor" class="class-function">constructor(items...)</a>
</li>
  <li class="searchable"><a href="#batman-set-length" class="class-function">length</a>
</li>
  <li class="searchable"><a href="#batman-set-isempty" class="class-function">isEmpty</a>
</li>
  <li class="searchable"><a href="#batman-set-toarray" class="class-function">toArray</a>
</li>
  <li class="searchable"><a href="#batman-set-has" class="class-function">has(item)</a>
</li>
  <li class="searchable"><a href="#batman-set-add" class="class-function">add(items...)</a>
</li>
  <li class="searchable"><a href="#batman-set-remove" class="class-function">remove(items...)</a>
</li>
  <li class="searchable"><a href="#batman-set-find" class="class-function">find(testFunction)</a>
</li>
  <li class="searchable"><a href="#batman-set-foreach" class="class-function">forEach(iteratorFunction[, context])</a>
</li>
  <li class="searchable"><a href="#batman-set-isempty" class="class-function">isEmpty()</a>
</li>
  <li class="searchable"><a href="#batman-set-clear" class="class-function">clear()</a>
</li>
  <li class="searchable"><a href="#batman-set-replace" class="class-function">replace(collection)</a>
</li>
  <li class="searchable"><a href="#batman-set-toarray" class="class-function">toArray()</a>
</li>
  <li class="searchable"><a href="#batman-set-merge" class="class-function">merge(collections...)</a>
</li>
  <li class="searchable"><a href="#batman-set-indexedby" class="class-function">indexedBy(key)</a>
</li>
  <li class="searchable"><a href="#batman-set-indexedbyunique" class="class-function">indexedByUnique(key)</a>
</li>
  <li class="searchable"><a href="#batman-set-sortedby" class="class-function">sortedBy(key)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-app" class="class">Batman.App</a>
<ul>
  <li class="searchable"><a href="#batman-app-batman-currentapp" class="class-function">Batman.currentApp</a>
</li>
  <li class="searchable"><a href="#batman-app-run" class="class-function">@run()</a>
<ul>
  <li ><a href="#batman-app-run-starting-an-application-with-domevents" class="">starting an application with DOMEvents</a>
</li>
  <li ><a href="#batman-app-run-starting-an-application-with-jquery" class="">starting an application with jQuery</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-app-stop" class="class-function">@stop()</a>
</li>
  <li class="searchable"><a href="#batman-app-routes" class="class-function">@routes</a>
</li>
  <li class="searchable"><a href="#batman-app-controllers" class="class-function">@controllers</a>
</li>
  <li class="searchable"><a href="#batman-app-layout" class="class-function">@layout</a>
</li>
  <li class="searchable"><a href="#batman-app-currentparams" class="class-function">@currentParams</a>
</li>
  <li class="searchable"><a href="#batman-app-paramsmanager" class="class-function">@paramsManager</a>
</li>
  <li class="searchable"><a href="#batman-app-paramspusher" class="class-function">@paramsPusher</a>
</li>
  <li class="searchable"><a href="#batman-app-run-class-event" class="class-function">&#39;run&#39; class event</a>
</li>
  <li class="searchable"><a href="#batman-app-ready-class-event" class="class-function">&#39;ready&#39; class event</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-app-routing" class="class">Batman.App Routing</a>
<ul>
  <li class="searchable"><a href="#batman-app-routing-resources" class="class-function">@resources</a>
</li>
  <li class="searchable"><a href="#batman-app-routing-member" class="class-function">@member</a>
</li>
  <li class="searchable"><a href="#batman-app-routing-collection" class="class-function">@collection</a>
</li>
  <li class="searchable"><a href="#batman-app-routing-route" class="class-function">@route</a>
</li>
  <li class="searchable"><a href="#batman-app-routing-root" class="class-function">@root</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-controller" class="class">Batman.Controller</a>
</li>
  <li class="searchable"><a href="#batman-model" class="class">Batman.Model</a>
<ul>
  <li class="searchable"><a href="#batman-model-the-identity-map" class="class-function">The Identity Map</a>
</li>
  <li class="searchable"><a href="#batman-model-subclassing" class="class-function">Subclassing</a>
</li>
  <li class="searchable"><a href="#batman-model-storage-adapters" class="class-function">Storage Adapters</a>
</li>
  <li class="searchable"><a href="#batman-model-primarykey" class="class-function">@primaryKey</a>
</li>
  <li class="searchable"><a href="#batman-model-storagekey" class="class-function">@storageKey</a>
</li>
  <li class="searchable"><a href="#batman-model-persist" class="class-function">@persist(mechanism)</a>
</li>
  <li class="searchable"><a href="#batman-model-encode" class="class-function">@encode(keys...[, encoderObject])</a>
</li>
  <li class="searchable"><a href="#batman-model-validate" class="class-function">@validate(keys...[, options])</a>
</li>
  <li class="searchable"><a href="#batman-model-all" class="class-function">@all</a>
</li>
  <li class="searchable"><a href="#batman-model-loaded" class="class-function">@loaded</a>
</li>
  <li class="searchable"><a href="#batman-model-clear" class="class-function">@clear()</a>
</li>
  <li class="searchable"><a href="#batman-model-find" class="class-function">@find(id, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-load" class="class-function">@load(options = {}, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-create" class="class-function">@create(attributes = {}, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-findorcreate" class="class-function">@findOrCreate(attributes = {}, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-id" class="class-function">id</a>
</li>
  <li class="searchable"><a href="#batman-model-dirtykeys" class="class-function">dirtyKeys</a>
</li>
  <li class="searchable"><a href="#batman-model-errors" class="class-function">errors</a>
</li>
  <li class="searchable"><a href="#batman-model-constructor" class="class-function">constructor(idOrAttributes = {})</a>
</li>
  <li class="searchable"><a href="#batman-model-isnew" class="class-function">isNew()</a>
</li>
  <li class="searchable"><a href="#batman-model-updateattributes" class="class-function">updateAttributes(attributes)</a>
</li>
  <li class="searchable"><a href="#batman-model-tostring" class="class-function">toString()</a>
</li>
  <li class="searchable"><a href="#batman-model-tojson" class="class-function">toJSON()</a>
</li>
  <li class="searchable"><a href="#batman-model-fromjson" class="class-function">fromJSON()</a>
</li>
  <li class="searchable"><a href="#batman-model-toparam" class="class-function">toParam()</a>
</li>
  <li class="searchable"><a href="#batman-model-state" class="class-function">state()</a>
</li>
  <li class="searchable"><a href="#batman-model-hasstorage" class="class-function">hasStorage()</a>
</li>
  <li class="searchable"><a href="#batman-model-load" class="class-function">load(options = {}, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-save" class="class-function">save(options = {}, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-destroy" class="class-function">destroy(options = {}, callback)</a>
</li>
  <li class="searchable"><a href="#batman-model-validate" class="class-function">validate(callback)</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-validationerror" class="class">Batman.ValidationError</a>
</li>
  <li class="searchable"><a href="#batman-errorsset" class="class">Batman.ErrorsSet</a>
</li>
  <li class="searchable"><a href="#batman-view" class="class">Batman.View</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings" class="class">Batman View Bindings</a>
<ul>
  <li class="searchable"><a href="#batman-view-bindings-how-to-use-bindings" class="class-function">How to use bindings</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-binding-keypaths" class="class-function">Binding Keypaths</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-binding-contexts" class="class-function">Binding Contexts</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-keypath-filters" class="class-function">Keypath Filters</a>
<ul>
  <li ><a href="#batman-view-bindings-keypath-filters-two-way-bindings-and-filters" class="">Two Way Bindings and Filters</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-view-bindings-keypath-literals" class="class-function">Keypath Literals</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-bind" class="class-function">data-bind</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-source" class="class-function">data-source</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-target" class="class-function">data-target</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-showif-data-hideif" class="class-function">data-showif / data-hideif</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-addclass-data-removeclass" class="class-function">data-addclass / data-removeclass</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-foreach" class="class-function">data-foreach</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-formfor" class="class-function">data-formfor</a>
<ul>
  <li ><a href="#batman-view-bindings-data-formfor-automatic-validation-display" class="">Automatic Validation Display</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-context" class="class-function">data-context</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-event" class="class-function">data-event</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-route" class="class-function">data-route</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-view" class="class-function">data-view</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-partial" class="class-function">data-partial</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-mixin" class="class-function">data-mixin</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-defineview" class="class-function">data-defineview</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-renderif" class="class-function">data-renderif</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-yield" class="class-function">data-yield</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-contentfor" class="class-function">data-contentfor</a>
</li>
  <li class="searchable"><a href="#batman-view-bindings-data-replace" class="class-function">data-replace</a>
</li>
</ul>
</li>
  <li class="searchable"><a href="#batman-view-filters" class="class">Batman View Filters</a>
<ul>
  <li class="searchable"><a href="#batman-view-filters-raw" class="class-function">raw(value)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-get" class="class-function">get(value, key)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-valuekey" class="class-function">value[key]</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-equals" class="class-function">equals(left, right)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-not" class="class-function">not(value)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-matches" class="class-function">matches(value, string)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-truncate" class="class-function">truncate(value, length, end = &#39;...&#39;)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-default" class="class-function">default(value, defaultValue)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-prepend" class="class-function">prepend(value, string)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-append" class="class-function">append(value, string)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-replace" class="class-function">replace(value, searchString, replaceString[, flags])</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-downcase" class="class-function">downcase(value)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-upcase" class="class-function">upcase(value)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-pluralize" class="class-function">pluralize(value, count)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-join" class="class-function">join(value, seperator = &#39;&#39;)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-sort" class="class-function">sort(value)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-map" class="class-function">map(iterable)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-has" class="class-function">has(iterable, item)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-first" class="class-function">first(iterable)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-meta" class="class-function">meta(value, keypath)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-iterpolate" class="class-function">iterpolate(string, valuesObject)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-witharguments" class="class-function">withArguments(function, curriedArguments...)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-routetoaction" class="class-function">routeToAction(model, action)</a>
</li>
  <li class="searchable"><a href="#batman-view-filters-escape" class="class-function">escape(value)</a>
</li>
</ul>
</li>
</ul>
</li>
        </ul>
      </nav>
    </div><!-- /.sidebar -->

    <!-- Content -->
    <div class="content" role="main">
      <h1 id="batman-js">batman.js</h1>
<p><a href="http://batmanjs.org/">batman.js</a> is a framework for building rich single-page browser applications. It is written in <a href="http://jashkenas.github.com/coffee-script/">CoffeeScript</a> and its API is developed with CoffeeScript in mind, but of course you can use plain old JavaScript too.

</p>
<h3 id="batman-js-its-got">It&#39;s got:</h3>
<ul>
<li>a stateful MVC architecture</li>
<li>a powerful binding system</li>
<li>routable controller actions</li>
<li>pure HTML views</li>
<li>toolchain support built on <a href="http://nodejs.org">node.js</a> and <a href="http://jashkenas.github.com/coffee-script/#cake">cake</a></li>
</ul>
<p>Batman&#39;s API is heavily inspired by <a href="http://rubyonrails.org/">Rails</a> and designed to make Rails devs feel right at home.

</p>
<h4 id="batman-js-its-got-platforms">Platforms</h4>
<p>Batman runs in node and the browser. Batman supports node v0.4.x and v0.6.x. We&#39;re targeting Chrome, Safari 4+, Firefox 3+, and IE 7+ for compatibility. Batman expects ES5 features like <code>Function::bind</code> and <code>Array::map</code>, so we recommend poly-filling these for older browsers with something like <a href="https://github.com/kriskowal/es5-shim">es5shim</a> or <a href="http://augmentjs.com/">augmentjs</a>. Batman also expects <code>JSON.parse</code>, which can be implemented in browsers without it using <a href="https://github.com/douglascrockford/JSON-js">json2.js</a>.

</p>
<h2 id="batman-js-installation">Installation</h2>
<p>Batman is available as a standalone download or as an <code>npm</code> package.

</p>
<h3 id="batman-js-installation-standalone-browser-version">Standalone Browser Version</h3>
<p>Versions of batman suitable for use in a web application are available at GitHub.

</p>
<h3 id="batman-js-installation-node-js">node.js</h3>
<p>If you haven&#39;t already, you&#39;ll need to install <a href="http://nodejs.org">node.js</a>. Then:

</p>
<pre><code class="bash"><div class="highlight"><pre>npm install -g batman
</pre></div></code></pre>
<p>Generate a new batman.js app somewhere, called my_app:

</p>
<pre><code class="bash"><div class="highlight"><pre><span class="nb">cd</span> ~/code
batman new my_app
</pre></div></code></pre>
<p>Fire it up:

</p>
<pre><code class="bash"><div class="highlight"><pre><span class="nb">cd </span>my_app
batman server <span class="c"># (or just &quot;batman s&quot;)</span>
</pre></div></code></pre>
<p>Now visit <a href="http://localhost:1047"><a href="http://localhost:1047">http://localhost:1047</a></a> and start playing around!

</p>
<h2 id="batman-js-architecture">Architecture</h2>
<p>Batman prescribes an MVC architecture for client side applications which fits together like this:

</p>
<ul>
<li>Models have validations, lifecycle events, a built-in identity map, and can be told how to persist themselves. (<code>Batman.LocalStorage</code>, <code>Batman.RestStorage</code>, and <code>Batman.RailsStorage</code> are included).</li>
<li>Views are JavaScript classes which render templates written in pure HTML. The templates use <code>data-*</code> attributes to create bindings to model data and trigger event handlers.</li>
<li>Controllers are persistent objects which mediate access to the model data, render the views, and handle events from the views.</li>
</ul>
<p>A batman.js application is served up in one page load, followed by asynchronous requests for various resources as the user interacts with the app. Navigation within the app can use <a href="https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history#Adding_and_modifying_history_entries">pushState</a> where supported, or fall back on to <a href="http://www.w3.org/QA/2011/05/hash_uris.html">hash-bang fragment identifers</a>.
</p>

<h2 id="batman-helpers">Batman Helpers</h2>
<p>Batman includes an number of useful, general purpose helper functions and references. They can all be found attached to the <code>Batman</code> object and can optionally be exported into the global namespace with a <code>$</code> prefix.

</p>
<h3 id="batman-helpers-container">container</h3>
<p><code>Batman.container</code> points to either the <code>window</code> object if running the browser, or the <code>global</code> object if running in node. This is useful if you want to add something to the global scope in all environments.

</p>
<h3 id="batman-helpers-typeof">typeOf(object) : string</h3>
<p><code>typeOf</code> determines a more specific type of an <code>object</code> than the native <code>typeof</code> operator in JavaScript. This is useful for a number of situations like dealing with <code>Object</code> promoted strings and numbers, or arrays which look like <code>object</code>s to <code>typeof</code>. Use <code>typeOf</code> when you need more than <code>&quot;object&quot;</code> from <code>typeof</code>.

</p>
<p><em>Note</em>: <code>typeOf</code> is substantially slower than <code>typeof</code>. <code>typeOf</code> works in a somewhat hackish manner by getting the <code>Object::toString</code> representation of the object and slicing it to retrieve the name of the constructor.

</p>
<div class="console-session">
  <h4>typeOf returns &quot;String&quot; for both strings and Object strings</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">primitive</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">objectified</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">primitive</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;string&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">objectified</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;object&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">typeOf</span><span class="p">(</span><span class="nx">primitive</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;String&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">typeOf</span><span class="p">(</span><span class="nx">objectified</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;String&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>typeOf returns Array for arrays</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">array</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">array</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;object&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">typeOf</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Array&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-mixin">mixin(subject, objects...) : subject</h3>
<p><code>mixin</code>, occasionally known elsewhere as <code>extend</code> or <code>merge</code>, flattens a series of objects onto the subject. Key/value pairs on objects passed as later arguments (arguments with a higher index) take precedence over earlier arguments. Returns the <code>subject</code> passed in with the new values.

</p>
<p><code>mixin</code> also has special properties that make it different than the canonical <code>extend</code> functions:

</p>
<ol>
<li>If the <code>subject</code> has a <code>set</code> function, <code>subject.set(key, value)</code> will be used to apply keys instead of <code>subject[key] = value</code>. This means that if the subject is a <code>Batman.Object</code>, observers and thus bindings on the object will be notified when other (Batmanified or not) objects are mixed into it.</li>
<li>If a mixed-in <code>object</code> has an <code>initialize</code> function defined, that function will be called and passed the <code>subject</code>. This is useful for custom extension logic, similar to <code>self.included</code> in Ruby. For this reason, the keys <code>initialize</code> and <code>uninitialize</code> are skipped by <code>mixin</code>.</li>
<li><code>mixin</code> only iterates over keys for which the <code><a href="function hasOwnProperty() { [native code] }">hasOwnProperty</a></code> test passes.</li>
</ol>
<p><em>Note</em>: <code>mixin</code> is destructive to (only) the first argument. If you need a non-destructive version of <code>mixin</code>, just pass an empty object as the first object, and all keys from the successive arguments will be applied to the empty object.

</p>
<div class="console-session">
  <h4>mixin merges argument objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">mixin</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="c1">// mixin returns the subject</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">subject</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="c1">// the subject is modified destructively</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>mixin merges argument objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">unmodified</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">mixin</span><span class="p">({},</span> <span class="nx">unmodified</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="c1">// mixin returns the subject</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">unmodified</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="c1">// argument objects are untouched allowing non-destructive merge</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>mixed in objects passed as higher indexed arguments take precedence</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">mixin</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">x</span><span class="o">:</span> <span class="mi">2</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">x</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-unmixin">unmixin(subject, objects...) : subject</h3>
<p><code>unmixin</code> &quot;unmerges&quot; the passes objects from the <code>subject</code>. If a key exists on any of the <code>objects</code> it will be <code>delete</code>d from the <code>subject</code>. Returns the <code>subject</code>.

</p>
<p><code>unmixin</code>, similar to <code>mixin</code>, supports calling an <code>uninitialize</code> function for each of the <code>objects</code> being unmixed in. If an <code>uninitialize</code> function exists on each

</p>
<div class="console-session">
  <h4>unmixin removes keys found on the unmixined objects on the subject</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">unmixin</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">fly</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="c1">// unmixin returns the subject</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">subject</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">funky</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="c1">// the subject is destructively modified.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-ischildof">isChildOf(parent : HTMLElement, child : HTMLElement) : boolean</h3>
<p><code>isChildOf</code> is a simple DOM helper which returns a boolean describing if the passed <code>child</code> node can be found in the descendants of the passed <code>parent</code> node.

</p>
<h3 id="batman-helpers-setimmediate">setImmediate(callback : Function) : object</h3>
<p><code>setImmediate</code> (and it&#39;s sister <code>clearImmediate</code>) are a more efficient version of <code>setTimeout(callback, 0)</code>. Due to timer resolution issues, setTimeout passed a timeout of 0 doesn&#39;t actually execute the function as soon as the JS execution stack has been emptied, but at minimum 4ms and maxmium 25ms after. For this reason Batman provides a cross browser implementation of <code>setImmediate</code> which does it&#39;s best to call the callback immediately after the stack empties. Batman&#39;s <code>setImmediate</code> polyfill uses the native version if available, <code>window.postmessage</code> trickery if supported, and falls back on <code>setTimeout(-&gt;, 0)</code>.

</p>
<p><code>setImmediate</code> returns a handle which can be passed to <code>clearImmediate</code> to cancel the future calling of the callback.

</p>
<h3 id="batman-helpers-clearimmediate">clearImmediate(handle)</h3>
<p><code>clearImmediate</code> stops the calling of a callback in the future when passed it&#39;s <code>handle</code> (which is returned from the <code>setImmediate</code> call used to enqueue it).

</p>
<h3 id="batman-helpers-foreach">forEach(iterable : object, iterator : Function[, context : Object])</h3>
<p>The <code>forEach</code> Batman helper is a universal iteration helper. When passed an <code>iterable</code> object, the helper will call the <code>iterator</code> (optionally in the <code>context</code>) for each item in the <code>iterable</code>. The <code>iterable</code> can be:

</p>
<ol>
<li>something which has it&#39;s own <code>forEach</code>, in which case the <code>iterator</code> whill just be passed to <code>iterable.forEach</code>.</li>
<li>an array like object, in which case a JavaScript <code>for(;;)</code> loop will be used to iterate over each entry</li>
<li>or an object, in which case a JavaScript <code>for-in</code> loop will be used to iterate over each entry.</li>
</ol>
<p>The <code>forEach</code> helper is useful for iterating over objects when the type of those objects isn&#39;t guaranteed.

</p>
<div class="console-session">
  <h4>forEach iterates over objects with forEach defined</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">set</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;a&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>forEach iterates over array like objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">ArrayLike</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">ArrayLike</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">imitation</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ArrayLike</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">imitation</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span../../../../../../WebContent/src/main/webapp/assets/batman/docs/js/quicksearch.jquery.jsspan><span class="p">(</span../../../../../../../../../../WebContent/src/main/webapp/assets/batmanjs/docs/js/quicksearch.jquery.jsn/webapp/assets/batman/docs/../../../../../../WebContent/src/main/webapp/assets/batmanjs/docs/js/docs.jsss="nx">imitation</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">imitation</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;b&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>forEach iterates over objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">object</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">x</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">({</span>
      <span class="nx">key</span><span class="o">:</span> <span class="nx">key</span><span class="p">,</span>
      <span class="nx">val</span><span class="o">:</span> <span class="nx">val</span>
    <span class="p">});</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
    <span class="nx">val</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-objecthaskey">objectHasKey(object, key) : boolean</h3>
<p><code>objectHasKey</code> returns a boolean describing the presence of the <code>key</code> in the passed <code>object</code>. <code>objectHasKey</code> delegates to the <code>object</code>&#39;s <code>hasKey</code> function if present, and otherwise just does a check using the JavaScript <code>in</code> operator.

</p>
<div class="console-session">
  <h4>objectHasKey verifies if a key is present in an object</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">objectHasKey</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">objectHasKey</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;flirty&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>objectHasKey verifies if a key is present in an object with `hasKey` defined</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleHash</span><span class="p">({</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">objectHasKey</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">objectHasKey</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;flirty&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-contains">contains(object, item) : boolean</h3>
<p><code>contains</code> returns a boolean describing if the given <code>object</code> has member <code>item</code>. Membership in this context is defined as:

</p>
<ul>
<li>the result of <code>object.has(item)</code> if the <code>object</code> has a <code>has</code> function defined</li>
<li>the result of <code>item in object</code> if the <code>object</code> is arraylike</li>
<li>the result of the Batman.objectHasKey otherwise</li>
</ul>
<p><em>Note</em>: When passed an object without a <code>has</code> function, <code>contains</code> will return <code>true</code> if the <code>object</code> has <code>item</code> as a <em><code>key</code></em>, not as a value at any key.

</p>
<p><code>contains</code> is useful for checking item membership when the type of the object can&#39;t be relied on.

</p>
<h3 id="batman-helpers-get">get(object, key) : value</h3>
<p><code>get</code> is a general purpose function for retrieving the value from a <code>key</code> on an <code>object</code> of an indeterminate type. This is useful if code needs to work with both <code>Batman.Object</code>s and Plain Old JavaScript Objects. <code>get</code> has the following semantics:

</p>
<ul>
<li>if the <code>object</code> has a <code>get</code> function defined, return the result of <code>object.get(key)</code></li>
<li>if the object does not have a <code>get</code> function defined, use an ephemeral <code>Batman.Property</code> to retrieve the key. This is equivalent to <code>object[key]</code> for single segment <code>key</code>s, but if the <code>key</code> is multi-segment (example: &#39;product.customer.name&#39;), <code>get</code> will do nested gets until the either <code>undefined</code> or the end of the keypath is reached.</li>
</ul>
<div class="console-session">
  <h4>get returns the value at a key on a POJO</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;flirty&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>get returns the value at a key on a Batman.Object</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">fit</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;flirty&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>get returns the value at a deep key on a POJO</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">customer</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Joe&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;customer.name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Joe&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;customer.age&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>get returns the value at a deep key on a Batman.Object</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">subject</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">customer</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Joe&quot;</span>
    <span class="p">}</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;customer.name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Joe&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span> <span class="s1">&#39;customer.age&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-escapehtml">escapeHTML(string) : string</h3>
<p><code>escapeHTML</code> takes a string of unknown origin and makes it safe for display on a web page by encoding control characters in HTML into their HTML entities.

</p>
<p><em>Warning</em>: Do not rely on <code>escapeHTML</code> to purge unsafe data from user submitted content. While <code>escapeHTML</code> is applied to every binding&#39;s contents by default, it should not be your only line of defence against script injection attacks.

</p>
<div class="console-session">
  <h4>escapeHTML encodes special characters into HTML entities</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">escapeHTML</span><span class="p">(</span><span class="s2">&quot;&amp; &lt; &gt; \&quot; &#39;&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;&amp;amp; &amp;lt; &amp;gt; &amp;#34; &amp;#39;&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h2 id="batman-helpers">Batman.helpers</h2>
<p><code>Batman.helpers</code> is a namespace for Batman&#39;s helpful string manipulation helpers.

</p>
<p><em>Note</em>: Batman&#39;s pluralization functions mirror those of Rails&#39; exactly.

</p>
<h3 id="batman-helpers-ordinalize">ordinalize(value : [number|string]) : string</h3>
<p><code>ordinalize</code> converts a given integer into an ordinal string for describing position in a list, like 1st, 2nd, or 20th.

</p>
<div class="console-session">
  <h4>ordinalize converts numbers to their ordinal form</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">ordinalize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;1st&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">ordinalize</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;2nd&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">ordinalize</span><span class="p">(</span><span class="mi">1002</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;1002nd&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">ordinalize</span><span class="p">(</span><span class="s2">&quot;1003&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;1003rd&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">ordinalize</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;-11th&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">ordinalize</span><span class="p">(</span><span class="o">-</span><span class="mi">1021</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;-1021st&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-singularize">singularize(pluralString : string) : string</h3>
<p><code>singularize</code> converts the plural form of a word to a singular form.

</p>
<div class="console-session">
  <h4>singularize converts plural words to singular words</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">singularize</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;post&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">singularize</span><span class="p">(</span><span class="s2">&quot;octopi&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;octopus&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">singularize</span><span class="p">(</span><span class="s2">&quot;sheep&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;sheep&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">singularize</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;word&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">singularize</span><span class="p">(</span><span class="s2">&quot;CamelOctopi&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;CamelOctopus&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-pluralize">pluralize(singularString : string) : string</h3>
<p><code>pluralize</code> converts the singular form of a word to the plural form.

</p>
<div class="console-session">
  <h4>pluralize converts plural words to singular words</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">pluralize</span><span class="p">(</span><span class="s2">&quot;post&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;posts&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">pluralize</span><span class="p">(</span><span class="s2">&quot;octopus&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;octopi&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">pluralize</span><span class="p">(</span><span class="s2">&quot;sheep&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;sheep&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">pluralize</span><span class="p">(</span><span class="s2">&quot;words&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;words&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">pluralize</span><span class="p">(</span><span class="s2">&quot;CamelOctopus&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;CamelOctopi&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-camelize">camelize(string, [lowercaseFirstLetter = false]) : string</h3>
<p><code>camelize</code> converts the passed <code>string</code> to UpperCamelCase. If the second argument is passed as <code>true</code>, then lowerCamelCase is returned.

</p>
<div class="console-session">
  <h4>camelize returns the CamelCase version of an under_scored word</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">camelize</span><span class="p">(</span><span class="s2">&quot;batman_object&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;BatmanObject&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">camelize</span><span class="p">(</span><span class="s2">&quot;batman_object&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;batmanObject&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-underscore">underscore(string) : string</h3>
<p><code>underscore</code> returns the underscored version of a CamelCase word.

</p>
<div class="console-session">
  <h4>underscore converts CamelCase to under_scores</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">underscore</span><span class="p">(</span><span class="s2">&quot;BatmanObject&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;batman_object&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-helpers-capitalize">capitalize(string) : string</h3>
<p><code>capitalize</code> does a word-wise capitalization of a phrase or word.

</p>
<div class="console-session">
  <h4>capitalize makes the first letter of each word in the string uppercase</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">(</span><span class="s2">&quot;batmanObject&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;BatmanObject&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">(</span><span class="s2">&quot;batman object&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Batman Object&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">helpers</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">(</span><span class="s2">&quot;AlreadyCapitalized&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;AlreadyCapitalized&quot;</span>
</pre></div></div></code>
  </pre>
</div>

<h2 id="batman-eventemitter">Batman.EventEmitter</h2>
<p><code>EventEmitter</code> is a mixin which can be applied to any object to give it the ability to fire events and accept listeners for those events.

</p>
<h3 id="batman-eventemitter-on">on(key, handler)</h3>
<p>Attaches a function <code>handler</code> to the event with name <code>key</code>. This function will be executed every time the event fires.

</p>
<div class="console-session">
  <h4>event handlers execute when attached with on</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;detonated&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-eventemitter-fire">fire(key, arguments...)</h3>
<p>Calls all previously attached handlers on the event with name <code>key</code>. All handlers will receive the passed <code>arguments</code>.

</p>
<p><em>Note</em>: Calling <code>fire</code> doesn&#39;t guarantee the event will fire since firing can be prevented with <code>prevent</code> or <code>preventAll</code>.

</p>
<div class="console-session">
  <h4>event handlers are fired</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">noise</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;detonated with noise &quot;</span> <span class="o">+</span> <span class="nx">noise</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="s2">&quot;BOOM!&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;detonated with noise BOOM!&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-eventemitter-hasevent">hasEvent(key) : boolean</h3>
<p>Asks if the <code>EventEmitter</code> has an event with the given <code>key</code>.

</p>
<div class="console-session">
  <h4>events can be tested for presence</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;detonated&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">hasEvent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">hasEvent</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-eventemitter-oneshot">oneShot : boolean</h3>
<p>Events can be set to fire only once, and then fire subsequently attached handlers immediately if they are attached after the initial firing. This is useful for events similar to <code>window.onload</code> where they really only happen once in the lifespan of the application, but you don&#39;t want to check if they have happened already when attaching event handlers.

</p>
<p>Access the <code>Event</code> object to set the <code>oneShot</code> property on them using <code>EventEmitter::event</code>.

</p>
<div class="console-session">
  <h4>one shot events fire handlers attached after they have fired for the first time</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">event</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">).</span><span class="nx">oneShot</span> <span class="o">=</span> <span class="kc">true</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;detonated immediately!!&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;detonated immediately!!&quot;</span> <span class="c1">// The handler was called as soon as it was attached.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-eventemitter-prevent">prevent(key) : EventEmitter</h3>
<p>Prevents the event with name <code>key</code> from firing, even if <code>.fire</code> is called. This is useful if you need to guarantee a precondition is in fulfilled before allowing event handlers to execute. Returns the event emitting object.

</p>
<p>Undo event prevention with <code>allow</code> or <code>allowAndFire</code>.

</p>
<p><em>Note</em>: <code>prevent</code> can be called more than once to effectively &quot;nest&quot; preventions. <code>allow</code> or <code>allowAndFire</code> must be called the same number of times or more for events to fire once more.


</p>
<div class="console-session">
  <h4>events can be prevented</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;This shouldn&#39;t fire&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span> <span class="c1">// The event handler wasn&#39;t fired.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>prevent returns the event emitter</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-eventemitter-allow">allow(key) : EventEmitter</h3>
<p>Allows the event with name <code>key</code> to fire once more, after <code>prevent</code> had been called previously. <code>allow</code> will not fire the event when called, regardless of weather or not the event can now be fired or if an attempt to fire it was made while the event was prevented. Returns the event emitting object.

</p>
<p><em>Note</em>: <code>prevent</code> can be called more than once to effectively &quot;nest&quot; preventions. <code>allow</code> or <code>allowAndFire</code> must be called the same number of times or more for events to fire once more.

</p>
<div class="console-session">
  <h4>events can be allowed after prevention</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;This will only fire once&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span> <span class="c1">// The event handler wasn&#39;t fired.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allow</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// The event handler was fired.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>events must be allowed the same number of times they have been prevented</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;This will only fire once&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span> <span class="c1">// The event handler wasn&#39;t fired, the prevent count is at 2.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allow</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span> <span class="c1">// The event handler still wasn&#39;t fired, but the prevent count is now at 1.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allow</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// The event handler was fired.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>allow returns the event emitter</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allow</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-eventemitter-allowandfire">allowAndFire(key)</h3>
<p>Allows the event with name <code>key</code> to fire once more, and tries to fire it. <code>allowAndFire</code> may fail to fire the event if <code>prevent</code> has been called more times than <code>allow</code> or <code>allowAndFire</code> have previous.

</p>
<div class="console-session">
  <h4>events can be allowed and fired after prevention</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;This will only fire once&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span> <span class="c1">// The event handler wasn&#39;t fired.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allowAndFire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// The event handler was fired.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>events must be be allowed and fired the same number of times they have been prevented</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span> <span class="o">=</span> <span class="nx">$mixin</span><span class="p">({},</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">EventEmitter</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;This will only fire once&quot;</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">prevent</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allowAndFire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span> <span class="c1">// The event handler wasn&#39;t fired.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">dynamite</span><span class="p">.</span><span class="nx">allowAndFire</span><span class="p">(</span><span class="s1">&#39;detonate&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// The event handler was fired.</span>
</pre></div></div></code>
  </pre>
</div>

<h2 id="batman-observable">Batman.Observable</h2>
<p><code>Batman.Observable</code> is a mixin which gives objects the ability to notify subscribers to changes on its properties. <code>Observable</code> also adds functionality for observing <em>keypaths</em>: arbitrarily deeply nested properties on objects.

</p>
<h3 id="batman-observable-get">get(keypath) : value</h3>
<p>Retrieves the value at a <code>key</code> on an object. Accepts keypaths.

</p>
<p><em>Note</em>: <code>get</code> must be used for property access on any object in <code>Batman</code>&#39;s world. This is so that Batman can implement neat things like automatic dependency calculation for computed properties, property caching where it is safe, and smart storage mechanisms. With Batman, you must use <code>get</code> instead of normal <code>.</code> property access.

</p>
<div class="console-session">
  <h4>get retrieves properties on Batman objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;bpm&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">120</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>get retrieves properties on nested Batman objects using keypaths</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">,</span>
    <span class="nx">author</span><span class="o">:</span> <span class="nx">Batman</span><span class="p">({</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Harry&quot;</span>
    <span class="p">})</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;author.name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Harry&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>get retrieves properties on Batman objects when . property access doesn&#39;t</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">song</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;undefined&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-observable-set">set(keypath, newValue) : newValue</h3>
<p>Stores the <code>value</code> at a <code>key</code> on an object. Accepts keypaths. Returns the new value of the property.

</p>
<p><em>Note</em>: Once more, <code>set</code> must be used for property mutation on all objects in the <code>Batman</code> world. This is again so that Batman can implement useful functionality like cache busting, eager recalculation of computed properties, and smarter storage.

</p>
<p><em>Note</em>: Custom setters can mutate the value during setting, so the value which was passed to <code>set</code> and <code>set</code>&#39;s return value are not guaranteed to be identical.

</p>
<div class="console-session">
  <h4>set stores properties on batman objects.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1000</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1000</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>set stores properties on nested Batman objects using keypaths</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">author</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Harry&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">,</span>
    <span class="nx">author</span><span class="o">:</span> <span class="nx">author</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;author.name&#39;</span><span class="p">,</span> <span class="s2">&quot;Nick&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Nick&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">author</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Nick&quot;</span> <span class="c1">// The value was set on the nested object.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>set is incompatible with &#39;.&#39; property mutation</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1000</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span> <span class="c1">// The song length reported by Batman is unchanged because set wasn&#39;t used to change the value.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-observable-unset">unset(keypath) : value</h3>
<p>Removes the value at the given <code>keypath</code>, leaving it <code>undefined</code>. Accepts keypaths. Returns the value the property had before unsetting.

</p>
<p><code>unset</code> is roughly equivalent to <code>set(keypath, undefined)</code>, however, custom properties can define a nonstandard <code>unset</code> function, so it is best to use <code>unset</code> instead of <code>set(keypath, undefined)</code> wherever possible.

</p>
<div class="console-session">
  <h4>unset removes the property on Batman objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">unset</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span> <span class="c1">// The value is unset.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>unset removes the property at a keypath</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">author</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Harry&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">,</span>
    <span class="nx">author</span><span class="o">:</span> <span class="nx">author</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">unset</span><span class="p">(</span><span class="s1">&#39;author.name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Harry&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">author</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span> <span class="c1">// The value was unset on the nested object.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-observable-observe">observe(key, observerCallback) : this</h3>
<p>Adds a handler to call when the value of the property at the <code>key</code> changes upon <code>set</code>ting. Accepts keypaths.

</p>
<p><code>observe</code> is the very core of Batman&#39;s usefulness. As long as <code>set</code> is used everywhere to do property mutation, any object can be observed for changes to its properties. This is critical to the concept of bindings, which Batman uses for it&#39;s views.

</p>
<p>The <code>observerCallback</code> gets called whenever the <code>key</code> changes with the arguments <code>newValue, oldValue</code>.

</p>
<p>Returns the object <code>observe</code> was called upon.

</p>
<div class="console-session">
  <h4>observe attaches handlers which get called upon change</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">300</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<p><em>Note</em>: <code>observe</code> works excellently on keypaths. If you attach a handler to a &quot;deep&quot; keypath, it will fire any time the value of that keypath changes, which is another way of saying the handler will fire when any segment of the keypath changes, passing in the new value at the end of the keypath.

</p>
<div class="console-session">
  <h4>observe attaches handlers which get called upon change</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">author</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Harry&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">,</span>
    <span class="nx">author</span><span class="o">:</span> <span class="nx">author</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;author.name&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newName</span><span class="p">,</span> <span class="nx">oldName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newName</span><span class="p">,</span> <span class="nx">oldName</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="nx">newAuthor</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;James&quot;</span>
  <span class="p">}))</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s2">&quot;James&quot;</span><span class="p">,</span> <span class="s2">&quot;Harry&quot;</span><span class="p">]</span> <span class="c1">// The observer fired when the &#39;author&#39; segment of the keypath changed.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-observable-observeandfire">observeAndFire(key, observerCallback) : this</h3>
<p>Adds the <code>observerCallback</code> as an observer to <code>key</code>, and fires it immediately. Accepts the exact same arguments and follows the same semantics as <code>Observable::observe</code>, but the observer is fired with the current value of the keypath it observers synchronously during the call to <code>observeAndFire</code>.

</p>
<p>During the initial synchronous firing of the <code>callback</code>, the <code>newValue</code> and <code>oldValue</code> arguments will be the same value: the current value of the property. This is because the old value of the property is not cached and therefore unavailable. If your observer needs the old value of the property, you must attach it before the <code>set</code> on the property happens.

</p>
<div class="console-session">
  <h4>observeAndFire calls the observer upon attaching it with the currentValue of the property</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observeAndFire</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="mi">340</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">300</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-observable-forget">forget([key [, observerCallback]]) : this</h3>
<p>If <code>observerCallback</code> and <code>key</code> are given, that observer is removed from the observers on <code>key</code>. If only a <code>key</code> is given, all observers on that key are removed. If no <code>key</code> is given, all observers on all keys are removed. Accepts keypaths.

</p>
<p>Returns the object <code>forget</code> was called upon.

</p>
<div class="console-session">
  <h4>forget removes an observer from a key if the key and the observer are given</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">observer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="nx">observer</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">forget</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="nx">observer</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">300</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">340</span><span class="p">]</span> <span class="c1">// The logged values haven&#39;t changed because the observer hasn&#39;t fired again.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>forget removes all observers from a key if only the key is given</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">observerA</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">observerB</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="nx">observerA</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="nx">observerB</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">2</span> <span class="c1">// Both length observers fired.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">forget</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">300</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">2</span> <span class="c1">// Nothing more has been logged because neither observer fired.</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>forget removes all observers from all key if no key is given</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">observerA</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">observerB</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">([</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">]);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="nx">observerA</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;bpm&#39;</span><span class="p">,</span> <span class="nx">observerB</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// The length observer fired.</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">forget</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">300</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;bpm&#39;</span><span class="p">,</span> <span class="mi">130</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">130</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">length</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// Nothing more has been logged because neither observer fired.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-observable-getorset">getOrSet(keypath, valueFunction) : value</h3>
<p>Assigns the <code>keypath</code> to the result of calling the <code>valueFunction</code> if the current value at the <code>keypath</code> is falsey. Returns the value of the property after the operation, be it changed or not. Equivalent to CoffeeScript&#39;s <code>||=</code> operator.

</p>
<div class="console-session">
  <h4>getOrSet doesn&#39;t set the property if it exists</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">getOrSet</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">500</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">340</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>getOrSet sets the property if it is falsey</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">getOrSet</span><span class="p">(</span><span class="s1">&#39;artist&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;Elvis&quot;</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Elvis&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;artist&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Elvis&quot;</span>
</pre></div></div></code>
  </pre>
</div>

<h2 id="batman-object">Batman.Object</h2>
<p><code>Batman.Object</code> is the superclass for virtually all objects in a Batman application. <code>Batman.Object</code> mixes in <code>Batman.Observable</code> and <code>Batman.EventEmitter</code> for things like <code>get</code>, <code>set</code>, <code>observe</code>, and <code>fire</code>, and then defines some more useful things for tying everything together.

</p>
<h3 id="batman-object-accessor">@accessor([keys...], objectOrFunction)</h3>
<p>Accessors are used to create properties on a class, prototype, or instance which can be fetched, set, and unset. These properties can be static, computed as functions of the other properties on the object the accessor belongs to, or properties of any Batman object in the system. <code>accessor</code> is a Batman and old browser friendly version of ES5 <code>Object.defineProperty</code> missing some of the goodness.

</p>
<p>The value of custom accessors can be observed just like any property. Accessors also track which other properties they rely on for computation, and recalculate eagerly when those other properties change. This way, when a source value is changed, any dependent accessors will automatically update any bindings to them with a new value. Accessors accomplish this feat by tracking <code>get</code> calls, so do be sure to use <code>get</code> to retrieve properties on Batman Objects inside accessors so those properties can be tracked as dependencies. The property dependencies of an accessor are called &quot;sources&quot; in the Batman world.

</p>
<p>Importantly, accessors are also inherited, so accessors defined anywhere in an object&#39;s prototype chain will be used. Following this, <code>@accessor</code> is meant to be used during the class definition of a class extending <code>Batman.Object</code>.

</p>
<h4 id="batman-object-accessor-arguments">Arguments</h4>
<p><code>@accessor</code> can be called with zero, one, or many keys for the accessor to define. This has the following effects:

</p>
<ul>
<li>zero: create a <code>defaultAccessor</code>, which will be called when no other properties or accessors on an object match a keypath. This is similar to <code>method_missing</code> in Ruby or <code>#doesNotUnderstand</code> in Smalltalk.</li>
<li>one: create a <code>keyAccessor</code> at the given key, which will only be called when that key is gotten, set, or unset.</li>
<li>many: create <code>keyAccessors</code> for each given key, which will then be called whenever each one of the listed keys is gotten, set, or unset.</li>
</ul>
<p><code>@accessor</code> accepts as the last argument either an object with any combination of the <code>get</code>, <code>set</code>, and <code>unset</code> keys defined. Functions which implement the behaviour for those particular actions on the property should reside at these keys. <code>@accessor</code> also accepts a function as the last argument, which is a shorthand for specifying the <code>get</code> implementation for the accessor.

</p>
<h4 id="batman-object-accessor-uses">Uses</h4>
<p>Accessors are a really useful addition to the world of JavaScript. You can now define transforms on simple properties which will automatically update when the properties they transform change, for example you might want to truncate a potentially long piece of text to display a summary elsewhere, or you might want to capitalize or <code>encodeURIComponent</code> a value before putting it in the view or the current URL.

</p>
<div class="console-session">
  <h4>@accessor can be called on a class to define how a property is calculated</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Post</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Post</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Post</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Post</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Post</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">({</span>
    <span class="nx">body</span><span class="o">:</span> <span class="s2">&quot;Why Batman is Useful: A lengthy post on an important subject&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Why Batman...&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<p>You can also use accessors to combine properties; the colloquial <code>fullName</code> example comes to mind, but all sorts of other complex logic can be abstracted away using the accessor pattern.

</p>
<div class="console-session">
  <h4>@accessor can define a transform on several properties</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">User</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">User</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">User</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">User</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">User</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;fullName&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;firstName&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;lastName&#39;</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">User</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">tim</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">({</span>
    <span class="nx">firstName</span><span class="o">:</span> <span class="s2">&quot;Tim&quot;</span><span class="p">,</span>
    <span class="nx">lastName</span><span class="o">:</span> <span class="s2">&quot;Thomas&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">tim</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;fullName&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Tim Thomas&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">tim</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;firstName&#39;</span><span class="p">,</span> <span class="s2">&quot;Timmy&quot;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">tim</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;fullName&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Timmy Thomas&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<p>Accessors can define custom <code>get</code>, <code>set</code>, and <code>unset</code> functions to support each operation on the property:

</p>
<div class="console-session">
  <h4>@accessor can define the get, set, and unset methods for the property</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">AbsoluteNumber</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">AbsoluteNumber</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">AbsoluteNumber</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">AbsoluteNumber</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">AbsoluteNumber</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
      <span class="p">},</span>
      <span class="nx">unset</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_value</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">AbsoluteNumber</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">number</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AbsoluteNumber</span><span class="p">({</span>
    <span class="nx">value</span><span class="o">:</span> <span class="o">-</span><span class="mi">10</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">number</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">10</span>
</pre></div></div></code>
  </pre>
</div>
<p>Importantly, it is also safe to use branching, loops, or whatever logic you want in accessor bodies:

</p>
<div class="console-session">
  <h4>@accessor can use arbitrary logic to define the value</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Player</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Player</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Player</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Player</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Player</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;played&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;goals&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;assists&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Player</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">({</span>
    <span class="nx">played</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">goals</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">assists</span><span class="o">:</span> <span class="mi">0</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;played&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">0</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;goals&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">6</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;assists&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">rick</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">7</span>
</pre></div></div></code>
  </pre>
</div>
<h4 id="batman-object-accessor-caveats">Caveats</h4>
<p>Accessors are extremely useful but you must keep these items in mind while programming using them:

</p>
<ol>
<li>Accessors should be linear, so they can be cached.</li>
</ol>
<p>Batman automatically memoizes the return value of accessors, and will not re-execute the body until one of the accessor&#39;s sources changes. If you need the accessor to recalculate every time the property is gotten, pass false as the <code>cacheable</code> in the accessor descriptor object (the last argument to the <code>@accessor</code> function).

</p>
<div class="console-session">
  <h4>@accessor usually caches results</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Example</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Example</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Example</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Example</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Example</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;cachedCounter&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="o">++</span><span class="nx">counter</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="nx">Example</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;notCachedCounter&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">++</span><span class="nx">counter</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="nx">cachable</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Example</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">example</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Example</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">example</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;cachedCounter&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">example</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;cachedCounter&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">example</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;cachedCounter&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span> <span class="c1">// The second and third calls do not execute the function</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">example</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;notCachedCounter&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">2</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">example</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;notCachedCounter&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">3</span> <span class="c1">// Passing cachable: false does re-execute the function</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">example</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;cachedCounter&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">1</span>
</pre></div></div></code>
  </pre>
</div>
<ol>
<li>Accessors <em>must</em> use <code>get</code> to access properties they use for computation</li>
</ol>
<p>Batman tracks an accessor&#39;s sources by adding a global hook to all <code>get</code>s done, so if you don&#39;t use <code>get</code> to access properties on objects, Batman can&#39;t know that that property is a source of the property your accessor defines, so it can&#39;t recompute that property when the source property changes. All properties on <code>Batman.Object</code> should be accessed using <code>get</code> and <code>set</code> regardless if the code occurs in an accessor body or not, but it is critical to do so in accessors so the sources of the accessor can be tracked.

</p>
<ol>
<li>Accessors can create memory leaks or performance bottlenecks</li>
</ol>
<p>If you return a brand new object by say merging a number of <code>Batman.Set</code>s or doing any sort of major and complete re-computation you run the risk of creating performance problems. This is because accessors can be called frequently and unpredictably, as they are recomputed every time one of their sources changes as well as upon every <code>set</code>. Instead of recomputing expensive things every time the accessor is called, try to use objects which do delta recomputation using observers. Practically this translates to using things like <code>new SetUnion(@get(&#39;setA&#39;), @get(&#39;setB&#39;))</code> instead of <code>@get(&#39;setA&#39;).merge(@get(&#39;setB&#39;))</code> in an accessor body.

</p>
<h3 id="batman-object-classaccessor">@classAccessor([keys...], objectOrFunction)</h3>
<p><code>classAccessor</code> defines an accessor on the class, in that gets and sets done on the class will use the accessor definition as an implementation. <code>@accessor</code> called on a class will define an accessor for all instances of that class, where as <code>@classAccessor</code> defines accessors on the class object itself. See <code>@accessor</code> for the details surrounding accessors.

</p>
<div class="console-session">
  <h4>@classAccessor defines an accessor on the class</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">SingletonDooDad</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">SingletonDooDad</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">SingletonDooDad</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">SingletonDooDad</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">SingletonDooDad</span><span class="p">.</span><span class="nx">classAccessor</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">();</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">SingletonDooDad</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">instance</span> <span class="o">=</span> <span class="nx">SingletonDooDad</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">SingletonDooDad</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="nx">instance</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span> <span class="c1">// A second get returns the same instance</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-mixin">@mixin(objects...) : prototype</h3>
<p><code>@mixin</code> is a handy function for mixing in <code>objects</code> to a class&#39; prototype. <code>@mixin</code> is implemented on top of the Batman level <code>mixin</code> helper, which means that keys from incoming <code>objects</code> will be applied using <code>set</code>, and any <code>initialize</code> functions on the <code>objects</code> will be called with the prototype being mixed into. Returns the prototype being mixed into.

</p>
<p><em>Note</em>: <code>@mixin</code>, similar to <code>@accessor</code>, applies to all instances of a class. If you need to mix in to the class itself, look at <code>classMixin</code>.
<em>note</em>: <code>@mixin</code>, once more similar to <code>@accessor</code>, is intended for use during the class definition of a <code>Batman.Object</code> subclass.

</p>
<div class="console-session">
  <h4>@mixin extends the prototype of a Batman.Object subclass</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">FishBehaviour</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">canBreathUnderwater</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">MammalBehaviour</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">canBreathAboveWater</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Platypus</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Platypus</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Platypus</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Platypus</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Platypus</span><span class="p">.</span><span class="nx">mixin</span><span class="p">(</span><span class="nx">FishBehaviour</span><span class="p">,</span> <span class="nx">MammalBehaviour</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Platypus</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">platypus</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Platypus</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">platypus</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;canBreathAboveWater&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">platypus</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;canBreathUnderwater&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-classmixin">@classMixin(objects...) : this</h3>
<p><code>@classMixin</code> allows mixing in objects to a class during that class&#39; definition. See <code>@mixin</code> for information about the arguments passed to mixin, but note that <code>@classMixin</code> applies to the class object itself, and <code>@mixin</code> applies to all instances of the class. Returns the class being mixed into.

</p>
<div class="console-session">
  <h4>@classMixin extends the Batman.Object subclass</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Singleton</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">initialze</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">subject</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">subject</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">subject</span><span class="p">;</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Highlander</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Highlander</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Highlander</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Highlander</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Highlander</span><span class="p">.</span><span class="nx">classMixin</span><span class="p">(</span><span class="nx">Singleton</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Highlander</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">instance</span> <span class="o">=</span> <span class="nx">Highlander</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">instance</span> <span class="o">===</span> <span class="nx">Highlander</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span> <span class="c1">// There can only be one.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-observeall">@observeAll(key, callback : function) : prototype</h3>
<p><code>@observeAll</code> extends the <code>Batman.Object</code> implementation of <code>Batman.Observable</code> with the ability to observe all instances of the class (and subclasses). Observers attached with <code>@observeAll</code> function exactly as if they were attached to the object directly. Returns the prototype of the class.

</p>
<p><em>Note</em>: <code>@observeAll</code> is intended to be used during the class definition for a <code>Batman.Object</code> subclass, but it can be called after the class has been defined as a function on the class. It supports being called after instances of the class have been instantiated as well.

</p>
<div class="console-session">
  <h4>@observeAll attaches handlers which get called upon change</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Song</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Song</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Song</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Song</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Song</span><span class="p">.</span><span class="nx">observeAll</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">newValue</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Song</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Song</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@observeAll can attach handlers after instance instantiation</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Song</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Song</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Song</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Song</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">Song</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Song</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">340</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">360</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">Song</span><span class="p">.</span><span class="nx">observeAll</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">newValue</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">200</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-constructor">constructor(objects...)</h3>
<p>To create a new <code>Batman.Object</code>, the <code>Batman.Object</code> constructor can be used, or, the <code>Batman</code> namespace is also a utility function for creating Batman objects. Each object passed in to the constructor will have all its properties applied to the new <code>Batman.Object</code> using <code>get</code> and <code>set</code>, so any custom getters or setters will be respected. Objects passed in last will have precedence over objects passed in first in the event that they share the same keys. The property copy from these objects is shallow.

</p>
<div class="console-session">
  <h4>Batman() function allows for handy creation of Batman.Objects</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">object</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">object</span><span class="p">.</span><span class="nx">get</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;function&#39;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Batman.Object constructor function accepts multiple mixin arguments and later mixins take precedence.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">song</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">length</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">120</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">bpm</span><span class="o">:</span> <span class="mi">130</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">100</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">song</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;bpm&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">130</span> <span class="c1">// The property from the second object passed to the constructor overwrites that from the first.</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-tojson">toJSON() : object</h3>
<p><code>toJSON</code> returns a vanilla JavaScript object representing this <code>Batman.Object</code>.

</p>
<div class="console-session">
  <h4>toJSON returns a vanilla JS object</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">object</span> <span class="o">=</span> <span class="nx">Batman</span><span class="p">({</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">object</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-hashkey">hashKey() : string</h3>
<p><code>hashKey</code> returns a unique string representing this particular <code>Batman.Object</code>. No two <code>Batman.Object</code>s will have the same <code>hashKey</code>.

</p>
<h3 id="batman-object-accessor">accessor([keys...], objectOrFunction)</h3>
<p><code>accessor</code> defines an accessor on one instance of an object instead of on all instances like the class level <code>@accessor</code>. See <code>@accessor</code> for the details surrounding accessors.

</p>
<div class="console-session">
  <h4>accessor can be called on an instance of Batman.Object to define an accessor just on that instance</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Post</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Post</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Post</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Post</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Post</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">({</span>
    <span class="nx">body</span><span class="o">:</span> <span class="s2">&quot;Why Batman is Useful: A lengthy post on an important subject&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Why Batman...&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;longSummary&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;longSummary&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Why Batman is Useful...&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>defining an accessor on an instance does not affect the other instances</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Post</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Post</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Post</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">Post</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">({</span>
    <span class="nx">body</span><span class="o">:</span> <span class="s2">&quot;Why Batman is Useful: A lengthy post on an important subject&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">otherPost</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">({</span>
    <span class="nx">body</span><span class="o">:</span> <span class="s2">&quot;Why State Machines Are Useful: Another lengthy post&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;longSummary&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">post</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;longSummary&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Why Batman is Useful...&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">otherPost</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;longSummary&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="k">void</span> <span class="mi">0</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-object-mixin">mixin(objects...) : this</h3>
<p><code>mixin</code> extends the object it&#39;s called on with the passed <code>objects</code> using the <code>Batman.mixin</code> helper. Returns the object it&#39;s called upon.

</p>
<p><em>Note</em>: Since the <code>Batman.mixin</code> helper is used, mixin functionality like using <code>set</code> to apply properties and calling <code>initialize</code> functions is included in the instance level <code>mixin</code> function.

</p>
<div class="console-session">
  <h4>mixin on an instance applies the keys from the mixed in object to the instance</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Snake</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Snake</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Snake</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Snake</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">Snake</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">snake</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Snake</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">snake</span><span class="p">.</span><span class="nx">mixin</span><span class="p">({</span>
    <span class="nx">canSlither</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nx">canHiss</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">snake</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;canSlither&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">snake</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;canHiss&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>

<h2 id="batman-simpleset">Batman.SimpleSet</h2>
<p><code>SimpleSet</code> is an implementation of the <code>Set</code> object you might expect to find in lots of other languages standard libraries. Sets are an enumerable but unordered collection of objects. A particular object may either be a member or not be a member of a particular set, but it may not belong to the set twice, as that would imply ordering. In the case of Batman, sets will tell you when items are added or removed through events, sets mix in the <code>Enumerable</code> module for handy iteration and aggregation, and can also generate indexes and sorts via <code>SetIndex</code> and <code>SetSort</code>.

</p>
<h4 id="batman-simpleset-simpleset-vs-set">SimpleSet vs Set</h4>
<p><code>SimpleSet</code> and <code>Set</code> are two distinct classes in Batman. <code>SimpleSet</code> implements the set semantics as described above, but it is <em>not</em> a <code>Batman.Object</code>, so properties on it (like it&#39;s <code>length</code> or <code>toArray</code>) can not be observed, and thus not bound. <code>Set</code> is a <code>Batman.Object</code>, so it can be observed, and thus plays nice with the accessor system. Use a <code>SimpleSet</code> only when you know nothing will need to be observed on the set you are creating, which usually isn&#39;t a valid assumption. If it is in fact correct, consider using a native array as well, because iteration and in fact membership checks will be faster.


</p>
<h3 id="batman-simpleset-constructor">constructor(items...)</h3>
<p>When creating a <code>SimpleSet</code>, items forming the initial set can be passed as separate arguments to the constructor

</p>
<div class="console-session">
  <h4>new SimpleSet constructor can be called without arguments</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>new SimpleSet constructor can be passed items to add to the set.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-length">length : number</h3>
<p>A count of the items in a <code>SimpleSet</code> can be found at it&#39;s <code>length</code> property.

</p>
<h3 id="batman-simpleset-has">has(item) : Boolean</h3>
<p><code>has</code> returns a boolean describing if the given <code>item</code> is a member of the set.

</p>
<div class="console-session">
  <h4>SimpleSet::has indicates if an item is a member of the set or not.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-add">add(items...) : Array</h3>
<p><code>add</code> adds 0 or more new items to the set. <code>add</code> returns an array of the items which have been newly added to the set, which is to say the intersection of the argument items and the set itself before addition.

</p>
<div class="console-session">
  <h4>SimpleSet::add adds an item to the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>SimpleSet::add returns only the new items that weren\&#39;t previously in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">).</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-remove">remove(items...) : Array</h3>
<p><code>remove</code> removes 0 or more items from the set. <code>remove</code> returns an array of the items which were successfully removed from the set, which is to say the intersection of the argument items and the set itself before removal.

</p>
<div class="console-session">
  <h4>SimpleSet::remove removes an item from the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>SimpleSet::remove returns only the new items that were previously in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">).</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-find">find(testFunction : function) : [Object]</h3>
<p><code>find</code> returns the first item within the set for which the <code>testFunction</code> called with the item returns <code>true</code>, or <code>undefined</code> if no item passes the test.

</p>
<p><em>Note</em>: <code>find</code> returns the first item the test passes for, but since set iteration has no specified order, no guarantee can be made about which item will be returned if more than one item in the set passes the test. However, set iteration order is stable, so <code>find</code> called on the same set twice should return the same item.


</p>
<div class="console-session">
  <h4>SimpleSet::find returns the first item for which the test function passes</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">2</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>SimpleSet::find returns undefined if no items pass the test function</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">set</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;undefined&#39;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-foreach">forEach(iteratorFunction : function[, context: Object])</h3>
<p><code>forEach</code> calls the <code>iteratorFunction</code> with each item in the set, optionally executing the <code>iteratorFunction</code> in the passed context. Returns <code>undefined</code>.

</p>
<p><em>Note</em>: Set iteration order is not defined, which is to say Set client code cannot rely on one item being iterated over before another, regardless of when the Set&#39;s items were added. If you need an ordered set, Batman provides <code>SetSort</code> for exactly this, while including the added benefit of observability. If you need a one time ordering of a set, you can get the array representation with <code>toArray</code> and then use vanilla JavaScript <code>sort</code> on that array.

</p>
<div class="console-session">
  <h4>SimpleSet::forEach iterates over each item in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">sum</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">6</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>SimpleSet::forEach iterates over each item in the set optionally in the provided context</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">context</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">sum</span><span class="o">:</span> <span class="mi">0</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sum</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">},</span> <span class="nx">context</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">context</span><span class="p">.</span><span class="nx">sum</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">6</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-isempty">isEmpty() : boolean</h3>
<p><code>isEmpty</code> returns a boolean: <code>true</code> if the set has no items, and <code>false</code> if it has any items.

</p>
<div class="console-session">
  <h4>SimpleSet::isEmpty returns true if the set has no items</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-clear">clear() : Array</h3>
<p><code>clear</code> removes all items from a set. Returns an array of all the items in the set.

</p>
<p><em>Note</em>: Set iteration order is not defined, so the order of the array of items returned by <code>clear</code> is undefined.

</p>
<div class="console-session">
  <h4>SimpleSet::clear empties the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">clear</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-replace">replace(collection : Enumerable) : Array</h3>
<p><code>replace</code> removes all the items in a set and then adds all the items found in another <code>collection</code>. The other collection must have a <code>toArray</code> function which returns an array representation of the collection. Returns the array of items added.

</p>
<div class="console-session">
  <h4>SimpleSet::replace empties the set and then adds items from a different collection</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">secondSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">secondSet</span><span class="p">).</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-toarray">toArray() : Array</h3>
<p><code>toArray</code> returns an array representation of the set.

</p>
<p><em>Note</em>: Set iteration order is not defined, so the order in which the set&#39;s items appear in the array is not defined. It is however stable, so the order of the items in two successive <code>toArray</code> calls where the set was not modified in between should be the same.

</p>
<div class="console-session">
  <h4>SimpleSet::toArray returns an array representation of the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-merge">merge(collections... : Enumerable) : SimpleSet</h3>
<p><code>merge</code> adds all the items in a set and all the items in the passed <code>collections</code> to a new set and returns it. A <code>collection</code> is an object which has a <code>forEach</code> function. It is a non-destructive collection union. The set <code>merge</code> is called on and each <code>collection</code> passed to <code>merge</code> remain unaffected.

</p>
<div class="console-session">
  <h4>SimpleSet::merge returns a new set with the items of the original set and the passed set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">abc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">def</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">typeOf</span><span class="p">(</span><span class="nx">set</span> <span class="o">=</span> <span class="nx">abc</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">def</span><span class="p">))</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;Object&#39;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-simpleset-indexedby">indexedBy(key : String) : SetIndex</h3>
<h3 id="batman-simpleset-indexedbyunique">indexedByUnique(key : String) : UniqueSetIndex</h3>
<h3 id="batman-simpleset-sortedby">sortedBy(key: String) : SetSort</h3>

<h2 id="batman-set">Batman.Set</h2>
<p><code>Set</code> is an observable, <code>Batman.Object</code> wrapper around <code>SimpleSet</code>.

</p>
<h4 id="batman-set-simpleset-vs-set">SimpleSet vs Set</h4>
<p><code>SimpleSet</code> and <code>Set</code> are two distinct classes in Batman. <code>SimpleSet</code> implements the basic set semantics, but it is <em>not</em> a <code>Batman.Object</code>, so properties on it (like it&#39;s <code>length</code> or <code>toArray</code>) can not be bound. <code>Set</code> is a <code>Batman.Object</code>, so it can be observed, and thus plays nice with the accessor system. Use a <code>SimpleSet</code> only when you know nothing will need to be observed on the set you are creating, which usually isn&#39;t a valid assumption. If it is in fact correct, consider using a native array as well, because iteration and in fact membership checks will be faster.

</p>
<h3 id="batman-set-constructor">constructor(items...)</h3>
<p>When creating a <code>Set</code>, items forming the initial set can be passed as separate arguments to the constructor

</p>
<div class="console-session">
  <h4>new Set constructor can be called without arguments</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>new Set constructor can be passed items to add to the set.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-length">length : number</h3>
<p>A count of the items in a <code>Set</code> can be found at it&#39;s <code>length</code> property.

</p>
<h3 id="batman-set-isempty">isEmpty : boolean</h3>
<p>Observable property for <code>isEmpty()</code>

</p>
<h3 id="batman-set-toarray">toArray : Array</h3>
<p>Observable property for <code>toArray()</code>. Whenever items are added or removed on the set, the <code>toArray</code> property will change. This is the mechanism by which Batman&#39;s view bindings get notified of collection updates.

</p>
<div class="console-session">
  <h4>observers on the toArray property fire when the set changes</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;toArray&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newArray</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">newArray</span><span class="p">.</span><span class="nx">sort</span><span class="p">());</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-has">has(item) : Boolean</h3>
<p><code>has</code> returns a boolean describing if the given <code>item</code> is a member of the set.

</p>
<p><em>Note</em>: Using <code>has(item)</code> in an accessor body will register the set <code>has</code> is called upon as a source of the property being calculated. This so that whenever the set changes, the property will be recalculated, because the set may now have or not have the item in question.

</p>
<div class="console-session">
  <h4>Set::has indicates if an item is a member of the set or not.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::has registers the set as a source of an accessor</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="p">(</span><span class="nx">Team</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Team</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Team</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">awards</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nx">Team</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;bestEver?&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;awards&#39;</span><span class="p">).</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;Stanley Cup&#39;</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Team</span><span class="p">;</span>

  <span class="p">})())</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Team</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">observeAndFire</span><span class="p">(</span><span class="s1">&#39;bestEver?&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">status</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;awards&#39;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;Eastern Conference Champs&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;awards&#39;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;Stanley Cup&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-add">add(items...)</h3>
<p><code>add</code> adds 0 or more new items to the set. <code>add</code> returns an array of the items which have been newly added to the set, which is to say the intersection of the argument items and the set itself before addition.

</p>
<p><code>add</code> fires the <code>itemsWereAdded</code> event with the list of items newly added to the set if that list has length greater than 0. This is to say the event will not be fired if the items passed to add were all already members of the set.

</p>
<div class="console-session">
  <h4>Set::add adds an item to the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::add returns only the new items that weren\&#39;t previously in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">).</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::add fires the itemsWereAdded event with the items newly added to the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereAdded&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span><span class="p">.</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::add does not fire the itemsWereAdded event if the added items were already in the set.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereAdded&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;undefined&#39;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-remove">remove(items...)</h3>
<p><code>remove</code> removes 0 or more items from the set. <code>remove</code> returns an array of the items which were successfully removed from the set, which is to say the intersection of the argument items and the set itself before removal.

</p>
<p><code>remove</code> fires the <code>itemsWereRemoved</code> event with the list of removed items if that list has length greater than 0. This is to say the event will not be fired if none of the passed items were members of the set.

</p>
<div class="console-session">
  <h4>Set::remove removes an item from the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::remove returns only the new items that were previously in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">).</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::remove fires the itemsWereRemoved event with the items removed to the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereRemoved&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span><span class="p">.</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::remove does not fire the itemsWereRemoved event if the removed items were not already members of the set.</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereRemoved&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;undefined&#39;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-find">find(testFunction : function) : [Object]</h3>
<p><code>find</code> returns the first item within the set for which the <code>testFunction</code> called with the item returns <code>true</code>, or <code>undefined</code> if no item passes the test.

</p>
<p><em>Note</em>: <code>find</code> returns the first item the test passes for, but since set iteration has no specified order, no guarantee can be made about which item will be returned if more than one item in the set passes the test. However, set iteration order is stable, so <code>find</code> called on the same set twice should return the same item.


</p>
<div class="console-session">
  <h4>Set::find returns the first item for which the test function passes</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">2</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::find returns undefined if no items pass the test function</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="k">typeof</span> <span class="nx">set</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;undefined&#39;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-foreach">forEach(iteratorFunction : function[, context: Object])</h3>
<p><code>forEach</code> calls the <code>iteratorFunction</code> with each item in the set, optionally executing the <code>iteratorFunction</code> in the passed context. Returns <code>undefined</code>.

</p>
<p><em>Note</em>: Set iteration order is not defined, which is to say Set client code cannot rely on one item being iterated over before another, regardless of when the Set&#39;s items were added. If you need an ordered set, Batman provides <code>SetSort</code> for exactly this, while including the added benefit of observability. If you need a one time ordering of a set, you can get the array representation with <code>toArray</code> and then use vanilla JavaScript <code>sort</code> on that array.

</p>
<p><em>Note</em>: Using <code>forEach()</code> in an accessor body will register the set iterated over as a source of the property being calculated. This so that whenever the set changes, the property will be recalculated. This can be come an issue if you iterate over a set and modify the set&#39;s items, as when the property recalculates that modification will potentially happen on item&#39;s it&#39;s happened on previously.

</p>
<div class="console-session">
  <h4>Set::forEach iterates over each item in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">sum</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">6</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::forEach iterates over each item in the set optionally in the provided context</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">context</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">sum</span><span class="o">:</span> <span class="mi">0</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sum</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">;</span>
  <span class="p">},</span> <span class="nx">context</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">context</span><span class="p">.</span><span class="nx">sum</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="mi">6</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::forEach registers the set as a source if called in an accessor body</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="p">(</span><span class="nx">Team</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Team</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Team</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">players</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nx">Team</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;willWinTheCup?&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">sedinCount</span><span class="p">;</span>
      <span class="nx">sedinCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">players</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">player</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">player</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;Sedin&#39;</span><span class="p">)</span> <span class="k">return</span> <span class="nx">sedinCount</span><span class="o">++</span><span class="p">;</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="nx">sedinCount</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Team</span><span class="p">;</span>

  <span class="p">})())</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Team</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">observeAndFire</span><span class="p">(</span><span class="s1">&#39;willWinTheCup?&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">status</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;willWinTheCup?&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;players&#39;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;Henrik Sedin&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;players&#39;</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;Daniel Sedin&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-isempty">isEmpty() : boolean</h3>
<p><code>isEmpty</code> returns a boolean: <code>true</code> if the set has no items, and <code>false</code> if it has any items.

</p>
<p><em>Note</em>: Using <code>isEmpty()</code> in an accessor body will register the set <code>isEmpty</code> is called on as a source of the property being calculated, so that whenever the set changes the property will be recalculated.

</p>
<div class="console-session">
  <h4>Set::isEmpty returns true if the set has no items</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::isEmpty registers the set as a source of an accessor</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="p">(</span><span class="nx">Team</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Team</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nb">Object</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Team</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">games</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nx">Team</span><span class="p">.</span><span class="nx">accessor</span><span class="p">(</span><span class="s1">&#39;seasonStarted?&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">games</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">();</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Team</span><span class="p">;</span>

  <span class="p">})())</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Team</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;seasonStarted?&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;games&#39;</span><span class="p">).</span><span class="nx">add</span><span class="p">({</span>
    <span class="nx">win</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">team</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;seasonStarted?&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-clear">clear() : Array</h3>
<p><code>clear</code> removes all items from a set. Returns an array of all the items in the set.

</p>
<p><code>clear</code> will fire the <code>itemsWereRemoved</code> event once with all the items in the set.

</p>
<p><em>Note</em>: Set iteration order is not defined, so the order of the array of items returned by <code>clear</code> is undefined.

</p>
<div class="console-session">
  <h4>Set::clear empties the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">false</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">clear</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::clear fires the itemsWereRemoved event with all the items in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereRemoved&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">clear</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span><span class="p">.</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-replace">replace(collection : Enumerable) : Array</h3>
<p><code>replace</code> removes all the items in a set and then adds all the items found in another <code>collection</code>. The other collection must have a <code>toArray</code> function which returns an array representation of the collection. Returns the array of items added.

</p>
<p><code>replace</code> will fire the <code>itemsWereRemoved</code> event once with all the items in the set, and then the <code>itemsWereAdded</code> event once with the items from the incoming collection.

</p>
<div class="console-session">
  <h4>Set::replace empties the set and then adds items from a different collection</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">secondSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">secondSet</span><span class="p">).</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::replace fires the itemsWereRemoved event with all the items in the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereRemoved&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">())</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span><span class="p">.</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>Set::replace fires the itemsWereAdded event with all the items in the incoming set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;itemsWereAdded&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">items</span><span class="p">;</span>
    <span class="nx">items</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">?</span> <span class="nx">__slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="k">return</span> <span class="nx">log</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">SimpleSet</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">))</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">logged</span><span class="p">.</span><span class="nx">last</span><span class="p">.</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-toarray">toArray() : Array</h3>
<p><code>toArray</code> returns an array representation of the set.

</p>
<p><em>Note</em>: Set iteration order is not defined, so the order in which the set&#39;s items appear in the array is not defined. It is however stable, so the order of the items in two successive <code>toArray</code> calls where the set was not modified in between should be the same.

</p>
<p><em>Note</em>: <code>toArray</code> is also an observable property.

</p>
<p><em>Note</em>: Using <code>toArray()</code> in an accessor body will register the set <code>toArray</code> is called on as a source of the property being calculated, so that whenever the set changes the property will be recalculated.

</p>
<div class="console-session">
  <h4>Set::toArray returns an array representation of the set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-merge">merge(collections... : Enumerable) : Set</h3>
<p><code>merge</code> adds all the items in a set and all the items in the passed <code>collections</code> to a new set and returns it. A <code>collection</code> is an object which has a <code>forEach</code> function. It is a non-destructive collection union. The set <code>merge</code> is called on and each <code>collection</code> passed to <code>merge</code> remain unaffected.

</p>
<p><em>Note</em>: Be careful about using <code>merge</code> within accessors. Calling <code>merge</code> in an accessor function body will register the set <code>merge</code> is called upon as a source of the property being calculated, which means each the set changes, the property will be recalculated. This means the merge will occur again each time, and return an entirely new <code>Set</code> instance. If the previously returned <code>Set</code> instance is retained after recalculation, this is a big memory leak. Instead of merging in accessors, try to use a <code>SetUnion</code> or a <code>SetIntersection</code>.

</p>
<div class="console-session">
  <h4>Set::merge returns a new set with the items of the original set and the passed set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">abc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">def</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">typeOf</span><span class="p">(</span><span class="nx">set</span> <span class="o">=</span> <span class="nx">abc</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">def</span><span class="p">))</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;Object&#39;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">sort</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-set-indexedby">indexedBy(key : String) : SetIndex</h3>
<h3 id="batman-set-indexedbyunique">indexedByUnique(key : String) : UniqueSetIndex</h3>
<h3 id="batman-set-sortedby">sortedBy(key: String) : SetSort</h3>





<h2 id="batman-app">Batman.App</h2>
<p><code>Batman.App</code> is the central object in any Batman application. It manages the routing table and the current URL parameters, as well as the initial start of the application. It should also be used as a namespace for models and views so that other objects can find them. Batman assumes that there will only ever be one <code>Batman.App</code> in use at once.

</p>
<h3 id="batman-app-batman-currentapp">Batman.currentApp</h3>
<p>A Batman-wide reference to the currently running <code>Batman.App</code>.

</p>
<h3 id="batman-app-run">@run() : App</h3>
<p><code>App.run</code> is the central entry point for a Batman application. <code>@run</code> takes these steps to initialize a Batman application:

</p>
<ol>
<li>Instantiate a <code>Dispatcher</code>, an internal object for mananging action dispatch to controllers.</li>
<li>Instantiate a <code>Navigator</code>, an internal object for managing the URL via pushState or hashbangs.</li>
<li>Instantiate the <code>layout</code> view according to the <code>layout</code> property on the <code>App</code>.</li>
<li>Wait for the layout view to fire it&#39;s <code>ready</code> event.</li>
<li>Start the first action dispatch by telling the <code>Navigator</code> to begin monitoring the URL.</li>
</ol>
<p><em>Note</em>: <code>@run</code> emits the <code>run</code> class event on the <code>App</code>, but not necessarily as soon as <code>@run</code> is called because the <code>layout</code> renders asynchronously and may need to fetch other components. If you need to execute code as soon as the <code>App</code> has started running, add a listener to the <code>run</code> event on the <code>App</code> class. If you need to execute code as soon as the layout has rendered, you can use the <code>ready</code> event on the <code>App</code> class.

</p>
<p><code>@run</code> can be called before or on the <code>load</code> DOMEvent of the window. <code>@run</code> will return the App if the commencement was successful and complete, or <code>false</code> if the App must wait for the <code>layout</code> to render or if the <code>App</code> has already run.


</p>
<h4 id="batman-app-run-starting-an-application-with-domevents">starting an application with DOMEvents</h4>
<pre><code class="coffeescript"><div class="highlight"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span> <span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="nx">MyApp</span><span class="p">.</span><span class="nx">run</span><span class="p">()</span>
</pre></div></code></pre>
<h4 id="batman-app-run-starting-an-application-with-jquery">starting an application with jQuery</h4>
<pre><code class="coffeescript"><div class="highlight"><pre><span class="nx">$</span> <span class="o">-&gt;</span>
  <span class="nx">MyApp</span><span class="p">.</span><span class="nx">run</span><span class="p">()</span>
</pre></div></code></pre>
<h3 id="batman-app-stop">@stop() : App</h3>
<p><code>@stop</code> stops the <code>App</code> it&#39;s called upon. The URL will stop being monitored and no more actions will be dispatched. In usual Batman development you shouldn&#39;t have to call this.

</p>
<h3 id="batman-app-routes">@routes</h3>
<p><code>@routes</code> is a class level property referencing the root level <code>NamedRouteQuery</code> which allows for binding to routes on objects. See <code>data-route</code> bindings for more information.

</p>
<h3 id="batman-app-controllers">@controllers</h3>
<p><code>@controllers</code> is a class level property containing the singleton <code>Batman.Controller</code> instances for each subclass in the application. This <code>controllers</code> directory puts these instances at the lowercase name of the controller. For example, the <code>TodosController</code> would be found at <code>controllers.todos</code>. <code>@controllers</code> ideally should never be bound to, but it is very useful for debugging in the console and other such workarounds.

</p>
<div class="console-session">
  <h4>App.controllers references a directory of controller instances</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Alfred</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Alfred</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">App</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Alfred</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Alfred</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">Alfred</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Alfred</span><span class="p">.</span><span class="nx">TodosController</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">TodosController</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Controller</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">TodosController</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">TodosController</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">TodosController</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">controller</span> <span class="o">=</span> <span class="nx">Alfred</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;controllers.todos&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Batman</span><span class="p">.</span><span class="nx">_functionName</span><span class="p">(</span><span class="nx">controller</span><span class="p">.</span><span class="nx">constructor</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;TodosController&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-app-layout">@layout</h3>
<h3 id="batman-app-currentparams">@currentParams</h3>
<h3 id="batman-app-paramsmanager">@paramsManager</h3>
<h3 id="batman-app-paramspusher">@paramsPusher</h3>
<h3 id="batman-app-run-class-event">&#39;run&#39; class event</h3>
<p>The <code>run</code> class event is fired once the app has run. This indeterminately but often happens before the app&#39;s layout has finished rendering.

</p>
<h3 id="batman-app-ready-class-event">&#39;ready&#39; class event</h3>
<p>The <code>ready</code> class event is fired once the app&#39;s layout is rendered.

</p>
<h2 id="batman-app-routing">Batman.App Routing</h2>
<p>The <code>Batman</code> routing DSL is similar to Rails 3&#39;s routing DSL.

</p>
<h3 id="batman-app-routing-resources">@resources</h3>
<h3 id="batman-app-routing-member">@member</h3>
<h3 id="batman-app-routing-collection">@collection</h3>
<h3 id="batman-app-routing-route">@route</h3>
<h3 id="batman-app-routing-root">@root</h3>

<h2 id="batman-controller">Batman.Controller</h2>

<h2 id="batman-model">Batman.Model</h2>
<p><code>Batman.Model</code> is responsible for representing data in your application, and for providing a fluid interface to moving in to and out of your backend.

</p>
<p><em>Note</em>: This documentation uses the term <em>model</em> to refer to the class level <code>Model</code> or <code>Model</code> subclass, and the term <em>record</em> to refer to one instance of a <code>Model</code> or <code>Model</code> subclass.

</p>
<h3 id="batman-model-the-identity-map">The Identity Map</h3>
<p>Batman uses an identity map when fetching and storing records to do it&#39;s best to only ever represent a backend record with exactly one client side record. This means that if you use <code>Model.find</code> twice to fetch a record with the same ID, you will get back the same (<code>===</code>) instance in each callback. This is useful because it means that any state the instance might be in is available and preserved no matter which piece of code asked for it, and so that bindings to the instance update no matter which piece of code actually updates the model.

</p>
<p>Practically, the identity map is an implementation detail on Batman&#39;s end and developers shouldn&#39;t have to actually interact with it, but the knowledge that you have the &quot;one true instance&quot; is helpful when reasoning about code and bindings.

</p>
<h3 id="batman-model-subclassing">Subclassing</h3>
<p>Models in your applications should be subclasses of <code>Batman.Model</code>, or subclasses of subclasses, and so on. Extending <code>Batman.Model</code> will give your domain class all the functionality. You can also subclass your own subclasses and things like encoders, validations, and storage adapters will be inherited by sub-subclasses.


</p>
<h3 id="batman-model-storage-adapters">Storage Adapters</h3>
<p><code>Batman.Model</code> alone only defines the logic surrounding loading and saving, but not the actual mechanism for doing so. This is left to a <code>Batman.StorageAdaper</code> subclass, 4 of which are included with Batman or in extras:

</p>
<ol>
<li><code>Batman.LocalStorage</code> for storing data in the browsers&#39; <code>localStorage</code>, if available.</li>
<li><code>Batman.SessionStorage</code> for storing data in the browser&#39;s <code>sessionStorage</code>, if available.</li>
<li><code>Batman.RestStorage</code> for using HTTP GET, POST, PUT, and DELETE to store data in a backend.</li>
<li><code>Batman.RailsStorage</code> which extends <code>Batman.RestStorage</code> with some handy Rails specific functionality like parsing out validation errors.</li>
</ol>
<h3 id="batman-model-primarykey">@primaryKey : string</h3>
<p><code>primaryKey</code> is a class level configuration option to change which key Batman uses as the primary key. Change the option using <code>set</code>, like so:

</p>
<div class="console-session">
  <h4>primary key can be set using @set</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;primaryKey&#39;</span><span class="p">,</span> <span class="s1">&#39;shop_id&#39;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Shop</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;primaryKey&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;shop_id&#39;</span>
</pre></div></div></code>
  </pre>
</div>
<p>The <code>primaryKey</code> is what Batman uses to compare instances to see if they represent the same domain-level object: if two records have the same value at the key specified by <code>primaryKey</code>, only one will be in the identity map. The key specified by <code>primaryKey</code> is also used by the associations system when determining if a record is related to another record, and by the remote storage adapters to generate URLs for records.

</p>
<p>Note_: The default primaryKey is &#39;id&#39;.

</p>
<h3 id="batman-model-storagekey">@storageKey : string</h3>
<p><code>storageKey</code> is a class level option which gives the storage adapters something to interpolate into their specific key generation schemes. In the case of <code>LocalStorage</code> or <code>SessionStorage</code> adapters, the <code>storageKey</code> defines what namespace to store this record under in the <code>localStorage</code> or <code>sessionStorage</code> host objects, and with the case of the <code>RestStorage</code> family of adapters, the <code>storageKey</code> assists in URL generation. See the documentation for the storage adapter of your choice for more information.

</p>
<p>The default <code>storageKey</code> is <code>null</code>.

</p>
<h3 id="batman-model-persist">@persist(mechanism : StorageAdapter) : StorageAdapter</h3>
<p><code>@persist</code> is how a <code>Model</code> subclass is told to persist itself by means of a <code>StorageAdapter</code>. <code>@persist</code> accepts either a <code>StorageAdapter</code> class or instance and will return either the instantiated class or the instance passed to it for further modification.

</p>
<div class="console-session">
  <h4>models can be told to persist via a storage adapter</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">persist</span><span class="p">(</span><span class="nx">Batman</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">hasStorage</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@persist returns the instantiated storage adapter</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">adapter</span> <span class="o">=</span> <span class="kc">false</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">adapter</span> <span class="o">=</span> <span class="nx">Shop</span><span class="p">.</span><span class="nx">persist</span><span class="p">(</span><span class="nx">Batman</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">adapter</span> <span class="k">instanceof</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">StorageAdapter</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@persist accepts already instantiated storage adapters</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">StorageAdapter</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">adapter</span><span class="p">.</span><span class="nx">someHandyConfigurationOption</span> <span class="o">=</span> <span class="kc">true</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">persist</span><span class="p">(</span><span class="nx">adapter</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">hasStorage</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-model-encode">@encode(keys...[, encoderObject : [Object|Function]])</h3>
<p><code>@encode</code> specifies a list of <code>keys</code> a model should expect from and send back to a storage adapter, and any transforms to apply to those attributes as they enter and exit the world of Batman in the optional <code>encoderObject</code>.

</p>
<p>The <code>encoderObject</code> should have an <code>encode</code> and/or a <code>decode</code> key which point to functions. The functions accept the &quot;raw&quot; data (the Batman land value in the case of <code>encode</code>, and the backend land value in the case of <code>decode</code>), and should return the data suitable for the other side of the link. The functions should have the following signatures:

</p>
<pre><code class="coffeescript"><div class="highlight"><pre><span class="nv">encoderObject = </span><span class="p">{</span>
  <span class="nv">encode: </span><span class="nf">(value, key, builtJSON, record) -&gt;</span>
  <span class="nv">decode: </span><span class="nf">(value, key, incomingJSON, outgoingObject, record) -&gt;</span>
<span class="p">}</span>
</pre></div></code></pre>
<p>By default these functions are the identity functions. They apply no transformation. The arguments for <code>encode</code> functions are as follows:

</p>
<ul>
<li><code>value</code> is the client side value of the <code>key</code> on the <code>record</code></li>
<li><code>key</code> is the key which the <code>value</code> is stored under on the <code>record</code>. This is useful when passing the same <code>encoderObject</code> which needs to pivot on what key is being encoded to different calls to <code>encode</code>.</li>
<li><code>builtJSON</code> is the object which is modified by each encoder which will eventually be returned by <code>toJSON</code>. To send the server the encoded value under a different key than the <code>key</code>, modify this object by putting the value under the desired key, and return <code>undefined</code>.</li>
<li><code>record</code> is the record on which <code>toJSON</code> has been called.</li>
</ul>
<p>For <code>decode</code> functions:

</p>
<ul>
<li><code>value</code> is the server side value of the <code>key</code> which will end up on the <code>record</code>.</li>
<li><code>key</code> is the key which the <code>value</code> is stored under the incoming JSON.</li>
<li><code>incomingJSON</code> is the JSON which is being decoded into the <code>record</code>. This can be used to create compound key decoders.</li>
<li><code>outgoingObject</code> is the object which is built up by the decoders and then <code>mixin</code>&#39;d to the record.</li>
<li><code>record</code> is the record on which <code>fromJSON</code> has been called.</li>
</ul>
<p>The <code>encode</code> and <code>decode</code> keys can also be false to avoid the default identity function encoder or decoder from being used.

</p>
<p><em>Note</em>: <code>Batman.Model</code> subclasses have no encoders by default, except for one which automatically decodes the <code>primaryKey</code> of the model, which is usually <code>id</code>. To get any data into or out of your model, you must white-list the keys you expect from the server or storage attribute.

</p>
<div class="console-session">
  <h4>@encode accepts a list of keys which are used during decoding</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">json</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Snowdevil&quot;</span><span class="p">,</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;snowdevil.ca&quot;</span>
  <span class="p">}</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Snowdevil&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@encode accepts a list of keys which are used during encoding</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Snowdevil&quot;</span><span class="p">,</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;snowdevil.ca&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Snowdevil&quot;</span><span class="p">,</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;snowdevil.ca&quot;</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@encode accepts custom encoders</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">encode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Snowdevil&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;SNOWDEVIL&quot;</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@encode accepts custom decoders</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">decode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Snow_devil&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;Snow devil&quot;</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@encode can be passed an encoderObject with false to prevent the default encoder or decoder</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Shop</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Shop</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Shop</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Shop</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">encode</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">decode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">Shop</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">Shop</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Shop</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Snowdevil&quot;</span><span class="p">,</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;snowdevil.ca&quot;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s1">&#39;Snowdevil&#39;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;url&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="s2">&quot;snowdevil.ca&quot;</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;snowdevil.ca&quot;</span>
  <span class="p">}</span> <span class="c1">// The name key is absent because of encode: false</span>
</pre></div></div></code>
  </pre>
</div>
<p>Some more handy examples:

</p>
<div class="console-session">
  <h4>@encode can be used to turn comma separated values into arrays</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Post</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Post</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Post</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Post</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">decode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">);</span>
      <span class="p">},</span>
      <span class="nx">encode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">array</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Post</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">({</span>
    <span class="nx">tags</span><span class="o">:</span> <span class="s1">&#39;new, hot, cool&#39;</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">)</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="s1">&#39;cool&#39;</span><span class="p">]</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">tags</span><span class="o">:</span> <span class="s1">&#39;new, hot, cool&#39;</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<div class="console-session">
  <h4>@encode can be used to turn arrays into sets</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Post</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Post</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Post</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Post</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">decode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">ctor</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">ctor</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ctor</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">func</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
          <span class="k">return</span> <span class="k">typeof</span> <span class="nx">result</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="o">?</span> <span class="nx">result</span> <span class="o">:</span> <span class="nx">child</span><span class="p">;</span>
        <span class="p">})(</span><span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span><span class="p">,</span> <span class="nx">array</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{});</span>
      <span class="p">},</span>
      <span class="nx">encode</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">set</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">set</span><span class="p">.</span><span class="nx">toArray</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Post</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">()</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">({</span>
    <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="s1">&#39;cool&#39;</span><span class="p">]</span>
  <span class="p">})</span>
</pre></div></div><div class="out"></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">)</span> <span class="k">instanceof</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Set</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="kc">true</span>
</pre></div></div><div class="in"><div class="highlight"><pre><span class="nx">record</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()</span>
</pre></div></div><div class="out"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="s1">&#39;cool&#39;</span><span class="p">]</span>
  <span class="p">}</span>
</pre></div></div></code>
  </pre>
</div>
<h3 id="batman-model-validate">@validate(keys...[, options : [Object|Function]])</h3>
<p>Validations allow a model to be marked as <code>valid</code> or <code>invalid</code> based on a set of programmatic rules. By validating a model&#39;s data before it gets to the server we can provide immediate feedback to the user about what they have entered and forgo waiting on a round trip to the server. <code>validate</code> allows the attachment of validations to the model on particular keys, where the validation is either a built in one (invoked by use of options to pass to them) or a custom one (invoked by use of a custom function as the second argument).

</p>
<p><em>Note</em>: Validation in Batman is always asynchronous, despite the fact that none of the validations may use an asynchronous operation to check for validity. This is so that the API is consistent regardless of the validations used.

</p>
<p>Built in validators are attached by calling <code>@validate</code> with options designating how to calculate the validity of the key:

</p>
<div class="console-session">
  <h4>@validate accepts options to check for validity</h4>
  <pre><code class="javascript"><div class="in"><div class="highlight"><pre><span class="nx">Post</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">__extends</span><span class="p">(</span><span class="nx">Post</span><span class="p">,</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span>

    <span class="kd">function</span> <span class="nx">Post</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Post</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">Post</span><span class="p">.</span><span class="nx">validate</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="p">{</span>
      <span class="nx">presence</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Post</span><span class="p">;</span>

  <span class="p">})()</span>
</pre></div></div><div class="out"></div></code>
  </pre>
</div>
<p>The built in validation options are listed below:

</p>
<ul>
<li><code>presence : boolean</code>: Assert that the string value is existant (not undefined nor null) and has length greather than 0.</li>
<li><code>numeric : true</code>: Assert that the value can be is or can be coerced into a number using <code>parseFloat</code>.</li>
<li><code>minLength : number</code>: Assert that the value&#39;s <code>length</code> property is greater than the given number.</li>
<li><code>maxLength : number</code>: Assert that the value&#39;s <code>length</code> property is less than the given number.</li>
<li><code>length : number</code>: Assert that the value&#39;s <code>length</code> property is exactly the given number.</li>
<li><code>lengthWithin : [number, number]</code> or <code>lengthIn : [number, number]</code>: Assert that the value&#39;s <code>length</code> property is within the ranger specified by the given array of two numbers, where the first number is the lower bound and the second number is the upper bound.</li>
</ul>
<p>Custom validators should have the signature <code>(errors, record, key, callback)</code>. The arguments are as follows:

</p>
<ul>
<li><code>errors</code>: an <code>ErrorsSet</code> instance which expects to have <code>add</code> called on it to add errors to the model</li>
<li><code>record</code>: the record being validated</li>
<li><code>key</code>: the key to which the validation has been attached</li>
<li><code>callback</code>: a function to call once validation has been complete. Calling this function is ++mandatory++.</li>
</ul>
<h3 id="batman-model-all">@all : Set</h3>
<h3 id="batman-model-loaded">@loaded : Set</h3>
<h3 id="batman-model-clear">@clear() : Set</h3>
<h3 id="batman-model-find">@find(id, callback : Function) : Model</h3>
<h3 id="batman-model-load">@load(options = {}, callback)</h3>
<h3 id="batman-model-create">@create(attributes = {}, callback) : Model</h3>
<h3 id="batman-model-findorcreate">@findOrCreate(attributes = {}, callback) : Model</h3>
<h3 id="batman-model-id">id : value</h3>
<h3 id="batman-model-dirtykeys">dirtyKeys : Set</h3>
<h3 id="batman-model-errors">errors : ErrorsSet</h3>
<h3 id="batman-model-constructor">constructor(idOrAttributes = {}) : Model</h3>
<h3 id="batman-model-isnew">isNew() : boolean</h3>
<h3 id="batman-model-updateattributes">updateAttributes(attributes) : Model</h3>
<h3 id="batman-model-tostring">toString() : string</h3>
<h3 id="batman-model-tojson">toJSON() : Object</h3>
<h3 id="batman-model-fromjson">fromJSON() : Model</h3>
<h3 id="batman-model-toparam">toParam() : value</h3>
<h3 id="batman-model-state">state() : string</h3>
<h3 id="batman-model-hasstorage">hasStorage() : boolean</h3>
<h3 id="batman-model-load">load(options = {}, callback)</h3>
<h3 id="batman-model-save">save(options = {}, callback)</h3>
<h3 id="batman-model-destroy">destroy(options = {}, callback)</h3>
<h3 id="batman-model-validate">validate(callback)</h3>
<h2 id="batman-validationerror">Batman.ValidationError</h2>
<h2 id="batman-errorsset">Batman.ErrorsSet</h2>



<h2 id="batman-view">Batman.View</h2>

<h2 id="batman-view-bindings">Batman View Bindings</h2>
<p>Batman&#39;s view bindings are how data gets show and collected from the user. They center on the notion of &quot;bindings&quot;: that the view representation and the JavaScript land value are always guaranteed to be in sync, such that when one changes, the other will reflect it.

</p>
<h3 id="batman-view-bindings-how-to-use-bindings">How to use bindings</h3>
<p>Bindings are declared as attributes on nodes under the <code>data</code> namespace. In practice, it looks like this:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">data-bind=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</pre></div></code></pre>
<p>This instantiates a binding on the <code>div</code> node which will update the node&#39;s <code>innerHTML</code> with the value found at the <code>name</code> keypath in the <a href="#batman-view-bindings-binding-contexts">current context</a>. Whenever the <code>name</code> key changes, the div&#39;s <code>innerHTML</code> will update to the new value.

</p>
<p>Nodes can have multiple bindings like this:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">&quot;body&quot;</span> <span class="na">data-showif=</span><span class="s">&quot;isPublished&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div></code></pre>
<p>or attribute bindings like this:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">data-bind-id=</span><span class="s">&quot;currentID&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div></code></pre>
<p>and bindings can be on inputs which the user can change, like this:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;title&quot;</span><span class="nt">&gt;&lt;/input&gt;</span>
</pre></div></code></pre>
<p>When the <code>title</code> property changes on the JavaScript object this <code>input</code> is bound to, the <code>input</code>&#39;s value will be updated. When the user types into the <code>input</code> (and <code>change</code> or <code>keyup</code> events are triggered), the <code>title</code> property in JavaScript land will be updated.

</p>
<h3 id="batman-view-bindings-binding-keypaths">Binding Keypaths</h3>
<p>A +keypath+ is the value of the HTML attribute a binding references. Importantly, keypaths can have multiple segments:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">&quot;order.customer.name&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div></code></pre>
<p>The keypath in the above HTML is <code>order.customer.name</code>. When you create a binding to a keypath like this (with dot separating segments), the binding will update the HTML value when +any+ of those segments change. In the above example, this means the <code>p</code> tag&#39;s <code>innerHTML</code> will be updated when:

</p>
<ol>
<li>the order changes,</li>
<li>the order&#39;s customer changes,</li>
<li>or the order&#39;s customer&#39;s name changes.</li>
</ol>
<p>This is important because it means you can rely on a binding to &quot;just work&quot; when anything it depends on changes. If say you had a <code>&lt;select&gt;</code> on the page which changed the <code>order</code>&#39;s <code>customer</code> property, bindings which bind to <code>order.customer.name</code> will update each time you change that select to reflect the new customer&#39;s name.

</p>
<h3 id="batman-view-bindings-binding-contexts">Binding Contexts</h3>
<p>All bindings render in a context. Binding contexts, known internally to Batman as <code>RenderContext</code>s, are objects which emulate the notion of variable scope in JavaScript code. When a controller action renders, it passes a context to the view consisting of itself, the <code>App</code>, and an object with a <code>window</code> key pointing to the host <code>window</code> object.

</p>
<h3 id="batman-view-bindings-keypath-filters">Keypath Filters</h3>
<p>Bindings can bind to filtered keypaths:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">&quot;post.body | truncate 100&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div></code></pre>
<p>The above <code>&lt;p&gt;</code> will have 100 characters worth of the post&#39;s body. Whenever the post&#39;s body changes, it will be retruncated and the <code>&lt;p&gt;</code>&#39;s <code>innerHTML</code> will be updated.

</p>
<p>Filter chains can be arbitrarily long:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;knight.title | prepend &#39;Sir&#39; | append &#39;, the honourable&#39;.&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</pre></div></code></pre>
<p>and filter chains can use other keypaths as arguments to the filters:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;person.name | prepend &#39; &#39; | prepend person.title&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</pre></div></code></pre>
<p>The above <code>&lt;span&gt;</code>&#39;s <code>innerHTML</code> will be updated whenever the person&#39;s name, or the person&#39;s title changes.

</p>
<h4 id="batman-view-bindings-keypath-filters-two-way-bindings-and-filters">Two Way Bindings and Filters</h4>
<p>Note that filtered keypaths can not propagate DOM land changes because values can&#39;t always be &quot;unfiltered&quot;. For example, if we bind an input to the truncated version of a string:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">data-bind=</span><span class="s">&quot;post.body | truncate 100&quot;</span><span class="nt">&gt;&lt;/input&gt;</span>
</pre></div></code></pre>
<p>The <code>&lt;input&gt;</code>&#39;s value can be updated when the <code>post.body</code> property changes but if a user types into this input field, they will edit the truncated body. If Batman updated the <code>post.body</code> property with the contents of the input, all characters which had been truncated will be lost to the nether. To avoid this loss of information and inconsistency, bindings to filtered keypaths will +only update from JavaScript land to HTML+, and never vice versa.

</p>
<h3 id="batman-view-bindings-keypath-literals">Keypath Literals</h3>
<p>Keypaths also support a select few literals within them. Numbers, strings, and booleans can be passed as arguments to filters or used as the actual value of the keypath.

</p>
<p>The following are all valid albeit contrived bindings:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="c">&lt;!-- String literal used as an argument --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">&quot;body | append &#39; ... &#39;&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>

<span class="c">&lt;!-- Boolean literal used as an argument --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">data-showif=</span><span class="s">&quot;shouldShow | default true&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>

<span class="c">&lt;!-- Number literal used as an argument --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">&quot;body | truncate 100&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>

<span class="c">&lt;!-- String literal used as the value --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">data-bind=</span><span class="s">&quot;&#39;Hardcoded&#39;&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>

<span class="c">&lt;!-- Boolean literal used as the value --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">data-showif=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</pre></div></code></pre>
<h3 id="batman-view-bindings-data-bind">data-bind</h3>
<p><code>data-bind</code> creates a two way binding between a property on a <code>Batman.Object</code> and an HTML element. Bindings created via <code>data-bind</code> will update the HTML element with the value of the JS land property as soon as they are created and each time the property changes after, and if the HTML element can be observed for changes, it will update the JS land property with the value from the HTML.

</p>
<p><code>data-bind</code> will change its behaviour depending on what kind of tag it is attached to:

</p>
<ul>
<li><code>&lt;input type=&quot;checkbox&quot;&gt;</code>: the binding will edit the <code>checked</code> property of the checkbox and populate the keypath with a boolean.</li>
<li><code>&lt;input type=&quot;text&quot;&gt;</code> and similar, <code>&lt;textarea</code>&gt;: the binding will edit the <code>value</code> property of the input and populate the keypath with the string found at <code>value</code>.</li>
<li><code>&lt;input type=&quot;file&quot;&gt;</code>: the binding will +not+ edit the <code>value</code> property of the input, but it will update the keypath with a host <code>File</code> object or objects if the node has the <code>multiple</code> attribute.</li>
<li><code>&lt;select&gt;</code>: the binding will edit the <code>selected</code> property of each <code>&lt;option&gt;</code> tag within the <code>&lt;select&gt;</code> match the property at the keypath. If the <code>&lt;select&gt;</code> has the multiple attribute, the value at the keypath can be an array of selected <code>&lt;option&gt;</code> values. You can also use <code>data-bind-selected</code> bindings on the individual options to toggle option selectedness.</li>
<li>All other tags: the binding will edit the <code>innerHTML</code> property of the tag and will not populate the keypath.</li>
</ul>
<p><code>data-bind</code> can also be used to bind an attribute of a node to a JavaScript property. Since attributes can&#39;t be observed for changes, this is a one way binding which will never update the JavaScript land property. Specify which attribute to bind using the &quot;double dash&quot; syntax like so: <code>data-bind-attribute=&quot;some.keypath&quot;</code>. For example, to bind the <code>placeholder</code> attribute of an input, use <code>data-bind-placeholder</code>.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">data-bind-placeholder=</span><span class="s">&quot;&#39;Specify a subtitle for product &#39; | append product.name&quot;</span><span class="nt">&gt;</span>
</pre></div></code></pre>
<p><em>Note</em>: <code>data-bind</code> will not update a JavaScript property if filters are used in the keypath.

</p>
<h3 id="batman-view-bindings-data-source">data-source</h3>
<p><code>data-source</code> creates a one way binding which propagates only changes from JavaScript land to the DOM, and never vice versa. <code>data-source</code> has the same semantics with regards to how it operates on different tags as <code>data-bind</code>, but it will only ever update the DOM and never the JavaScript land property.

</p>
<p>For example, the HTML below will never update the <code>title</code> property on the product, even if the user changes it. Each time the <code>title</code> attribute changes from a <code>set</code> in JavaScript land, the value of the input will be updated to the new value of <code>title</code>, erasing any potential changes that have been made to the value of the input by the user.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">data-source=</span><span class="s">&quot;product.title&quot;</span><span class="nt">&gt;</span>
</pre></div></code></pre>
<p><em>Note</em>: <code>data-source-attribute</code> is equivalent to <code>data-bind-attribute</code>, since the former is defined as never making JS land changes, and the latter is unable to.

</p>
<h3 id="batman-view-bindings-data-target">data-target</h3>
<p><code>data-target</code> creates a one way binding which propagates only changes from the DOM to JavaScript land, and never vice versa. <code>data-target</code> has the same semantics with regards to how it operates on different tags as <code>data-bind</code>, but it will never update the DOM even if the JavaScript land value changes.

</p>
<p><em>Note</em>: <code>data-target-attribute</code> is unavailable, because DOM changes to node attributes can&#39;t be monitored.


</p>
<h3 id="batman-view-bindings-data-showif-data-hideif">data-showif / data-hideif</h3>
<p><code>data-showif</code> and <code>data-hideif</code> bind to keypaths and show or hide the node they appear on based on the truthiness of the result. <code>data-showif</code> will show a node if the given keypath evaluates to something truthy, and <code>data-hideif</code> will leave a node visible until it&#39;s given keypath becomes truthy, at which point the node will be hidden. <code>data-showif</code> and <code>data-hideif</code> show and hide nodes by adding <code>display: none !important;</code> to the node&#39;s <code>style</code> attribute.

</p>
<p>For example, the if the HTML below were rendered where the keypath <code>product.published</code> evaluated to true, the <code>&lt;button&gt;</code> will be visible.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;button</span> <span class="na">data-showif=</span><span class="s">&quot;product.published&quot;</span><span class="nt">&gt;</span>Unpublish Product<span class="nt">&lt;/button&gt;</span>
</pre></div></code></pre>
<p>This is the Batman equivalent of a templating language&#39;s <code>if</code> construct, and  where else branches are implemented using the opposite binding.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;button</span> <span class="na">data-showif=</span><span class="s">&quot;product.published&quot;</span><span class="nt">&gt;</span>Unpublish Product<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;button</span> <span class="na">data-hideif=</span><span class="s">&quot;product.published&quot;</span><span class="nt">&gt;</span>Publish Product<span class="nt">&lt;/button&gt;</span>
</pre></div></code></pre>
<h3 id="batman-view-bindings-data-addclass-data-removeclass">data-addclass / data-removeclass</h3>
<p><code>data-addclass</code> and <code>data-removeclass</code> bindings can be used to conditionally add or remove a class from a node based on a boolean keypath. Specify the class to add using the &quot;double dash&quot; syntax; for example,<code>data-addclass-big=&quot;some.keypath&quot;</code> on a node will add the &quot;big&quot; class to that node&#39;s classes if <code>some.keypath</code> is truthy. <code>data-removeclass</code> will remove a class (usually one which is present in the HTML) if the keypath passed to it is truthy.

</p>
<p>The outer span in the HTML below will have an &quot;error&quot; class when the <code>product.errors.length</code> keypath evaluates to anything other than 0, since 0 is falsy and other numbers are truthy.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;span</span> <span class="na">data-addclass-error=</span><span class="s">&quot;product.errors.length&quot;</span><span class="nt">&gt;</span>This product has <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;product.errors.length&quot;</span><span class="nt">&gt;&lt;/span&gt;</span> errors.<span class="nt">&lt;/button&gt;</span>
</pre></div></code></pre>
<h3 id="batman-view-bindings-data-foreach">data-foreach</h3>
<p><code>data-foreach</code> is used to loop over an iterable object in Batman views. <code>data-foreach</code> duplicates the node it occurs on for each item in the collection found at the keypath given to it, and renders each duplicated node with that node&#39;s object from the collection by putting it in the context under a name passed to it using the &quot;double dash&quot; syntax.

</p>
<p>The <code>&lt;option&gt;</code> node below will be duplicated for each item in the <code>Set</code> at the <code>products</code> keypath.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;select&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">data-foreach-product=</span><span class="s">&quot;products&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;product.name&quot;</span><span class="nt">&gt;&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></div></code></pre>
<p>Batman will execute the <code>data-foreach</code> binding before the <code>data-bind</code> on the <code>&lt;option&gt;</code> node, which means that the <code>data-bind</code> will be processed for each duplicated node with each separate Product in the <code>products</code> Set in scope for each separate node. If there were say 3 Products in the <code>products</code> set, the HTML would look similar to this once rendered:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;select&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">data-bind=</span><span class="s">&quot;product.name&quot;</span><span class="nt">&gt;</span>Product A<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">data-bind=</span><span class="s">&quot;product.name&quot;</span><span class="nt">&gt;</span>Product B<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">data-bind=</span><span class="s">&quot;product.name&quot;</span><span class="nt">&gt;</span>Product C<span class="nt">&lt;/option&gt;</span>
  <span class="c">&lt;!-- end products --&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</pre></div></code></pre>
<p><code>data-foreach</code> can be used to iterate over <code>Batman.Set</code>s, and most often should be, because it observes any Sets and will update the DOM with new nodes if items are added to the set, or remove nodes from the DOM if their corresponding nodes are removed from the set. <code>data-foreach</code> is, like each other binding, keypath aware, such that if the <code>Set</code> instance at the keypath changes, or any previous segment of the keypath changes, <code>data-foreach</code> will remove all the nodes currently in the DOM, and add new nodes for each new item in the incoming <code>Set</code>.

</p>
<p><em>Note</em>: <code>data-foreach</code> expects to find an iterable object at the keypath given to it, and will emit a warning if it finds <code>undefined</code>.

</p>
<h3 id="batman-view-bindings-data-formfor">data-formfor</h3>
<p><code>data-formfor</code> creates a special addition to the context stack to represent a object under edit within a form. Usually this object is a model. Using the double dash syntax the name for the model to reside under can be specified.

</p>
<h4 id="batman-view-bindings-data-formfor-automatic-validation-display">Automatic Validation Display</h4>
<p><code>data-formfor</code> also has some handy functionality for displaying the result of validating the object under edit in the form. This will only be enabled if the object has an <code>errors</code> Set, which <code>Batman.Models</code> certainly do.

</p>
<p>If a tag matching the relative selector <code>.errors</code> is found, will populate this element with a list of the errors found during validation on the object. The selector for the errors container can be changed by adding a <code>data-errors-list</code> attribute with the value of the selector to the form with the <code>data-formfor</code> binding on it, or editing <code>Batman.DOM.FormBinding::defaultErrorsListSelector</code>.

</p>
<p>If value bindings are made using <code>data-bind</code> to attributes on the model within the form, automatic <code>data-addclass-error</code> bindings will be added to the elements on which the <code>data-bind</code> occurs to add the &quot;error&quot; class when the model has errors on the attribute which <code>data-bind</code> binds to.

</p>
<p>In the HTML below, an automatic <code>data-addclass-error</code> will be added to the <code>&lt;input&gt;</code> which activates when the <code>product</code> model has validation errors on the <code>name</code> attribute.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">data-formfor-product=</span><span class="s">&quot;currentProduct&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">data-bind=</span><span class="s">&quot;product.name&quot;</span><span class="nt">&gt;&lt;/input&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div></code></pre>
<p>The class which gets automatically added to inputs binding to invalid attributes can be customized by editing <code>Batman.DOM.FormBinding::errorClass</code>.

</p>
<h3 id="batman-view-bindings-data-context">data-context</h3>
<p><code>data-context</code> bindings add the object found at the key to the context stack, optionally under a key using the double dash syntax.

</p>
<p>For example, if a <code>product</code> object exists in the current context, the <code>data-context</code> binding below will expose its attributes at the root level of the context:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">data-context=</span><span class="s">&quot;product&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;cost&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></code></pre>
<p>Contexts added to the stack can also be scoped under a key using <code>data-context-</code>:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">data-context-currentProduct=</span><span class="s">&quot;product&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;currentProduct&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;currentProduct&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></code></pre>
<p>This is a useful mechanism for passing local variables to partial views.

</p>
<h3 id="batman-view-bindings-data-event">data-event</h3>
<p><code>data-event</code> bindings add DOM event listeners to the nodes they exist on which call the function found at the passed keypath. <code>data-event</code> bindings use the double dash syntax to specify the name of the event to listen for.

</p>
<p>In the HTML below, if the keypath <code>controller.nextAction</code> resolves to a function, that function will be executed each time the <code>&lt;button&gt;</code> element is clicked.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;button</span> <span class="na">data-event-click=</span><span class="s">&quot;controller.nextAction&quot;</span><span class="nt">&gt;&lt;/button&gt;</span>
</pre></div></code></pre>
<p>Functions which <code>data-event</code> calls will be passed the node and the <code>DOMEvent</code> object: <code>(node, event) -&gt;</code>.

</p>
<p><code>data-event</code> supports the following types of events formally and should &quot;do the right thing&quot; when attached to elements which fire these events:

</p>
<ul>
<li>click</li>
<li>doubleclick</li>
<li>change</li>
<li>submit</li>
</ul>
<p>If the event name used doesn&#39;t match the above events, the event name used will just fall through and be passed to <code>window.addEventListener</code>.

</p>
<h3 id="batman-view-bindings-data-route">data-route</h3>
<p><code>data-route</code> bindings are used to dispatch a new controller action upon the clicking of the node they bind to. <code>data-route</code> expects to find either a string or a <code>NamedRouteQuery</code> at the keypath passed to it. With this route, it will add an event handler to the <code>click</code> action of the element which dispatches the route and prevents the default action of the DOMEvent. <code>data-route</code> will also populate the <code>href</code> attribute if it occurs on an <code>&lt;a&gt;</code> tag so that other functons like &quot;Copy Link Address&quot; and Alt+Click continue to work on the link.

</p>
<p>The first way to use <code>data-route</code> are by passing it a string, which can be built using filters or an accessor, but the preferred way is to use the <code>NamedRouteQuery</code>. These objects are generated for you by starting keypaths at the <code>App.routes</code> property. All <code>Batman.App</code>s have a <code>routes</code> property which holds a nested list of all the routes, which you descend into by passing various key segments and objects. Since the <code>App</code> object is present in the default context stack, <code>data-route</code> keypaths can just start with <code>routes</code> like so.

</p>
<p>For example, assume the following routes definition in the current <code>Batman.App</code>:

</p>
<pre><code class="coffeescript"><div class="highlight"><pre><span class="k">class</span> <span class="nx">Alfred</span> <span class="k">extends</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">App</span>
  <span class="nx">@resources</span> <span class="s1">&#39;todos&#39;</span>
</pre></div></code></pre>
<p>This means that routes like <code>/todos</code> and <code>/todos/:id</code> exist. To route to the collection action, use the plural name of the resource:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">data-route=</span><span class="s">&quot;routes.todos&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
</pre></div></code></pre>
<p>To route to an individual todo things get a bit more complicated. If we have a Todo model with ID# <code>42</code> in the context as <code>todo</code>, use the <code>get</code> filter shorthand on the <code>NamedRouteQuery</code> returned by <code>routes.todos</code> to generate a member route:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">data-route=</span><span class="s">&quot;routes.todos[todo]&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
</pre></div></code></pre>
<p>Underneath this is doing <code>Alfred.get(&#39;routes.todos&#39;).get(todo)</code>; that is to say the todo object is being passed as a key to the <code>NamedRouteQuery</code>, which knows how to generate a member route when given a record. The above HTML when rendered will look like this:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">data-route=</span><span class="s">&quot;routes.todos[todo]&quot;</span> <span class="na">href=</span><span class="s">&quot;/todos/42&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
</pre></div></code></pre>
<p>This syntax can be extended to nested routes. If we have nested routes, we can use chained gets to generated nested routes

</p>
<pre><code class="coffeescript"><div class="highlight"><pre><span class="k">class</span> <span class="nx">Tracker</span> <span class="k">extends</span> <span class="nx">Batman</span><span class="p">.</span><span class="nx">App</span>
  <span class="nx">@resources</span> <span class="s1">&#39;villians&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
    <span class="nx">@resources</span> <span class="s1">&#39;crimes&#39;</span>
</pre></div></code></pre>
<p>Routes for collection and member crimes should look like <code>/villians/:villian_id/crimes</code> and <code>/villians/:villian_id/crimes/:id</code> respectively. Assuming the presence of a <code>villian</code> and a <code>crime</code> in the context, chained <code>get</code>s on <code>NamedRouteQuery</code>s achieve this:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="c">&lt;!-- Collection of crimes for a particular villian --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">data-route=</span><span class="s">&quot;routes.villians[villian].crimes&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
<span class="c">&lt;!-- One crime of a particular villian --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">data-route=</span><span class="s">&quot;routes.villians[villian].crimes[crime]&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
</pre></div></code></pre>
<p><em>Note</em>: <code>data-route</code> bindings route only to internal dispatch, and not external links. Use a regular <code>&lt;a&gt;</code> tag to link away from the application.

</p>
<h3 id="batman-view-bindings-data-view">data-view</h3>
<p><code>data-view</code> bindings attach custom <code>Batman.View</code> instances or instantiate custom <code>View</code> subclasses to / on a node. <code>data-view</code> expects either a <code>Batman.View</code> instance or subclass at the keypath passed to it. If an instance is passed, it will <code>set</code> the <code>node</code> property of the view to the node the <code>data-view</code> occurs on. If a class is passed, that class will be instantiated with the context the <code>data-view</code> binding executed in and with the node it occurred upon. See <code>Batman.View</code> for more information on custom Views and their uses.

</p>
<p><em>Note</em>: <code>data-view</code> bindings will bind to the passed keypath until it exists, that is to say until the value of it is not <code>undefined</code>. After the <code>View</code> has been set up, the <code>data-view</code> binding will remove itself and stop observing the keypath.

</p>
<h3 id="batman-view-bindings-data-partial">data-partial</h3>
<p><code>data-partial</code> pulls in a partial template and renders it in the current context of the node the <code>data-partial</code> occurs in. <code>data-partial</code> expects the name of the view to render in the value of the HTML attribute. <strong>Warning</strong>: This value is not a keypath. The HTML attribute&#39;s value is interpreted as a string, and the template which resides at that view path will be rendered.

</p>
<p>If we have this HTML at <code>views/villains/_stub.html</code> in our app:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;villian.name&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</pre></div></code></pre>
<p>and in <code>views/villians/show.html</code> we have this HTML:

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>A villian!<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;div</span> <span class="na">data-partial=</span><span class="s">&quot;villians/_stub&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</pre></div></code></pre>
<p>the contents of the <code>stub</code> partial will be inserted and rendered in the <code>&lt;div&gt;</code> above.

</p>
<h3 id="batman-view-bindings-data-mixin">data-mixin</h3>
<h3 id="batman-view-bindings-data-defineview">data-defineview</h3>
<h3 id="batman-view-bindings-data-renderif">data-renderif</h3>
<h3 id="batman-view-bindings-data-yield">data-yield</h3>
<h3 id="batman-view-bindings-data-contentfor">data-contentfor</h3>
<h3 id="batman-view-bindings-data-replace">data-replace</h3>
<h2 id="batman-view-filters">Batman View Filters</h2>
<h3 id="batman-view-filters-raw">raw(value) : string</h3>
<p>The <code>raw</code> filter renders the value unescaped.

</p>
<pre><code class="html"><div class="highlight"><pre><span class="nt">&lt;span</span> <span class="na">data-bind=</span><span class="s">&quot;someHTMLyString | raw&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
</pre></div></code></pre>
<h3 id="batman-view-filters-get">get(value, key) : value</h3>
<h3 id="batman-view-filters-valuekey">value[key] : value</h3>
<p>Shorthand for the <code>get</code> filter.

</p>
<h3 id="batman-view-filters-equals">equals(left, right) : boolean</h3>
<h3 id="batman-view-filters-not">not(value) : boolean</h3>
<h3 id="batman-view-filters-matches">matches(value, string) : boolean</h3>
<h3 id="batman-view-filters-truncate">truncate(value, length, end = &#39;...&#39;) : string</h3>
<h3 id="batman-view-filters-default">default(value, defaultValue) : value</h3>
<h3 id="batman-view-filters-prepend">prepend(value, string) : string</h3>
<h3 id="batman-view-filters-append">append(value, string) : string</h3>
<h3 id="batman-view-filters-replace">replace(value, searchString, replaceString[, flags]) : string</h3>
<h3 id="batman-view-filters-downcase">downcase(value) : string</h3>
<h3 id="batman-view-filters-upcase">upcase(value) : string</h3>
<h3 id="batman-view-filters-pluralize">pluralize(value, count) : string</h3>
<h3 id="batman-view-filters-join">join(value, seperator = &#39;&#39;) : string</h3>
<h3 id="batman-view-filters-sort">sort(value) : value</h3>
<h3 id="batman-view-filters-map">map(iterable) : value</h3>
<h3 id="batman-view-filters-has">has(iterable, item) : boolean</h3>
<h3 id="batman-view-filters-first">first(iterable) : value</h3>
<h3 id="batman-view-filters-meta">meta(value, keypath) : value</h3>
<h3 id="batman-view-filters-iterpolate">iterpolate(string, valuesObject) : string</h3>
<h3 id="batman-view-filters-witharguments">withArguments(function, curriedArguments...) : function</h3>
<h3 id="batman-view-filters-routetoaction">routeToAction(model, action) : string</h3>
<h3 id="batman-view-filters-escape">escape(value) : string</h3>



    </div><!-- /.content -->


  </div><!-- /.container -->

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery.min.js"><\/script>')</script> 
  <script src="js/quicksearch.jquery.js"></script> 
  <script src="js/docs.js"></script>

</body>
</html>
